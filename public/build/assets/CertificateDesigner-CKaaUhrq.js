import{d as e,j as t,S as n,a as s,H as a,e as r}from"./vendor-KZSLvCor.js";import{T as o}from"./Toast-hpu2Jnrp.js";function l({element:n,isSelected:s,previewData:a,onMouseDown:r,onDrag:o,onResize:l,onDragStop:i,onDelete:c}){const d=e.useRef(null),x=e.useRef(!1),m=e.useRef(!1),p=e.useRef({x:0,y:0}),u=e.useRef(null);e.useEffect(()=>()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",b)},[]);const h=e=>{e.preventDefault();const t=e.clientX,s=e.clientY,a=t-p.current.x,r=s-p.current.y;m.current?(l(n.id,a,r,u.current),p.current={x:t,y:s}):x.current&&(o(a,r),p.current={x:t,y:s})},b=()=>{(x.current||m.current)&&i&&i(n.id),x.current=!1,m.current=!1,u.current=null,document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",b)},f={position:"absolute",left:"".concat(n.x,"%"),top:"".concat(n.y,"%"),cursor:x.current?"grabbing":"grab",border:s?"1px solid #06b6d4":"1px solid transparent",boxShadow:s?"0 0 0 1px rgba(6, 182, 212, 1)":"none",userSelect:"none",transform:"translate(0, 0)",zIndex:s?50:10,transition:x.current||m.current?"none":"border 0.2s, box-shadow 0.2s"};return t.jsxs("div",{ref:d,onMouseDown:e=>{e.stopPropagation(),e.target.dataset.handle||(r(e,n.id),x.current=!0,m.current=!1,p.current={x:e.clientX,y:e.clientY},document.addEventListener("mousemove",h),document.addEventListener("mouseup",b))},onClick:e=>e.stopPropagation(),style:f,className:"group draggable-item",children:[s&&t.jsx("div",{onClick:e=>{e.stopPropagation(),e.preventDefault(),c(n.id)},className:"position-absolute rounded-circle bg-danger text-white shadow-sm border",style:{width:"15px",height:"15px",top:"-18px",right:"-16px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",cursor:"pointer",zIndex:60,padding:"0",margin:"0"},title:"Delete",children:t.jsx("i",{className:"fas fa-times"})}),(()=>{const e={width:"100%",height:"100%"};if("qrcode"===n.type)return t.jsx("div",{style:{...e,width:n.width,height:n.width,background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"9px",color:"#000",textAlign:"center",padding:"5px",borderRadius:"8px"},children:t.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 p-1 bg-white border",children:[t.jsx("i",{className:"fas fa-qrcode fa-3x mb-1"}),t.jsx("div",{style:{fontSize:"0.6em",textTransform:"uppercase",fontWeight:"bold"},children:"SCAN ME"})]})});if("shape"===n.type)return t.jsx("div",{style:{...e,width:n.width,height:n.height,backgroundColor:n.color||"#000000",borderRadius:"circle"===n.shapeType?"50%":"4px"}});if("line"===n.type)return t.jsx("div",{style:{width:n.width,height:n.height,backgroundColor:n.color||"#000000"}});if("image"===n.type||"signature"===n.type)return t.jsx("div",{style:{width:n.width},children:t.jsx("img",{src:n.src,style:{width:"100%",pointerEvents:"none"}})});let r=n.text;!a||s||"text"!==n.type&&"variable"!==n.type||Object.keys(a).forEach(e=>{const t=new RegExp("{{\\s*".concat(e,"\\s*}}"),"gi");r=r.replace(t,a[e])});const o=n.width&&n.width>0;return t.jsx("div",{style:{fontSize:"".concat(n.fontSize||14,"px"),color:n.color||"#000000",fontWeight:n.fontWeight||"normal",fontFamily:n.fontFamily||"Arial",fontStyle:n.fontStyle||"normal",textDecoration:n.textDecoration||"none",textAlign:n.textAlign||"left",width:o?"".concat(n.width,"px"):"auto",whiteSpace:o?"normal":"nowrap",wordWrap:o?"break-word":"normal",padding:"4px 8px",lineHeight:1.2,border:s&&o?"1px dashed #cbd5e1":"none"},children:r})})(),(()=>{if(!s)return null;if(!["shape","image","signature","qrcode","text","variable"].includes(n.type))return null;const e={width:"10px",height:"10px",background:"#fff",border:"1px solid #7c3aed",borderRadius:"50%",position:"absolute",zIndex:51};return t.jsx(t.Fragment,{children:[{id:"se",cursor:"nwse-resize",style:{bottom:"-5px",right:"-5px"}},{id:"sw",cursor:"nesw-resize",style:{bottom:"-5px",left:"-5px"}},{id:"ne",cursor:"nesw-resize",style:{top:"-5px",right:"-5px"}},{id:"nw",cursor:"nwse-resize",style:{top:"-5px",left:"-5px"}},{id:"e",cursor:"ew-resize",style:{top:"50%",right:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",backgroundColor:"#7c3aed",background:"#fff",border:"1px solid #7c3aed"}},{id:"w",cursor:"ew-resize",style:{top:"50%",left:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",background:"#fff",border:"1px solid #7c3aed"}}].map(n=>t.jsx("div",{"data-handle":n.id,onMouseDown:e=>((e,t)=>{e.stopPropagation(),e.preventDefault(),m.current=!0,x.current=!1,u.current=t,p.current={x:e.clientX,y:e.clientY},document.addEventListener("mousemove",h),document.addEventListener("mouseup",b)})(e,n.id),style:{...e,...n.style,cursor:n.cursor}},n.id))})})()]})}const i=({type:n="horizontal",length:s=3e3,zoom:a=1,theme:r,offset:o=0,onDragStart:l})=>{const i="horizontal"===n,c=e.useMemo(()=>{const e=[];for(let t=0;t<=3e3;t+=10)e.push({pos:t,isMajor:t%100==0,label:t});return e},[]),d=i?{width:"100%",height:"24px",borderBottom:"1px solid ".concat((null==r?void 0:r.borderColor)||"#ccc"),backgroundColor:(null==r?void 0:r.bg)||"#f8f9fa",overflow:"hidden"}:{width:"24px",height:"100%",borderRight:"1px solid ".concat((null==r?void 0:r.borderColor)||"#ccc"),backgroundColor:(null==r?void 0:r.bg)||"#f8f9fa",overflow:"hidden"},x={position:"absolute",[i?"left":"top"]:o,[i?"top":"left"]:0,transformOrigin:"0 0"};return t.jsx("div",{className:"ruler-".concat(n," d-flex position-relative user-select-none"),style:d,onMouseDown:e=>{e.preventDefault(),l&&l(n,e)},children:t.jsx("div",{style:x,children:c.map(({pos:e,isMajor:n,label:s})=>t.jsx("div",{className:"position-absolute",style:{[i?"left":"top"]:"".concat(e*a,"px"),[i?"top":"left"]:0,width:i?"1px":n?"12px":"6px",height:i?n?"12px":"6px":"1px",backgroundColor:(null==r?void 0:r.tickColor)||"#94a3b8"},children:n&&t.jsx("span",{className:"position-absolute fs-10",style:{fontSize:"9px",color:(null==r?void 0:r.textColor)||"#64748b",fontWeight:"600",[i?"left":"top"]:"4px",[i?"top":"left"]:"2px",transform:i?"none":"rotate(-90deg) translateX(-100%)",transformOrigin:"top left",whiteSpace:"nowrap"},children:s})},e))})})};function c({show:a,onClose:r,files:o=[],onSelect:l,uploadUrl:i,onUploadSuccess:c,onDelete:d,onRename:x}){const m=e.useRef(null),[p,u]=e.useState(""),[h,b]=e.useState(new Set),[f,g]=e.useState([]),[y,w]=e.useState(!1),v=e.useMemo(()=>p?o.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())):o,[o,p]);if(e.useEffect(()=>{a||(b(new Set),g([]))},[a]),!a)return null;const j=e=>{const t=[];Array.from(e).forEach(e=>{if(e.size>2097152)return void n.fire({icon:"error",title:"File too large",text:"".concat(e.name," exceeds 2MB limit."),customClass:{popup:"rounded-xl shadow-2xl border-0"}});const a={id:Math.random().toString(36).substring(7),file:e,name:e.name,progress:0,status:"pending",errorMsg:null};t.push(a),(async e=>{var t,n,a;const r=new FormData;r.append("file",e.file);try{g(t=>t.map(t=>t.id===e.id?{...t,status:"uploading"}:t)),await s.post(i,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t=>{const n=Math.round(100*t.loaded/t.total);g(t=>t.map(t=>t.id===e.id?{...t,progress:n}:t))}}),g(t=>t.map(t=>t.id===e.id?{...t,status:"success",progress:100}:t)),c(),setTimeout(()=>{g(t=>t.filter(t=>t.id!==e.id))},3e3)}catch(o){console.error("Upload failed",o);let s="Upload failed";(null==(n=null==(t=o.response)?void 0:t.data)?void 0:n.message)?s=o.response.data.message:422===(null==(a=o.response)?void 0:a.status)?s="Validation error":o.message&&(s=o.message),g(t=>t.map(t=>t.id===e.id?{...t,status:"error",errorMsg:s}:t))}})(a)}),t.length>0&&g(e=>[...e,...t])};return t.jsxs("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:3e3,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:r,children:[t.jsx("style",{children:"\n                .swal2-container { z-index: 10000 !important; }\n                /* Overlay Styles */\n                .media-actions { opacity: 0; transition: opacity 0.2s ease; background-color: rgba(0, 0, 0, 0.4); }\n                .media-card:hover .media-actions { opacity: 1; }\n                .media-card.selected .media-actions { opacity: 1; background-color: rgba(0, 0, 0, 0.1); }\n                \n                .media-card { transition: all 0.2s ease; }\n                .media-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }\n                .custom-scrollbar::-webkit-scrollbar { width: 6px; }\n                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n                .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }\n                .button-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); border: none; }\n                .text-shadow { text-shadow: 0 1px 2px rgba(0,0,0,0.3); }\n                .drop-zone-active { border: 2px dashed #6366f1; background-color: rgba(99, 102, 241, 0.05); }\n            "}),t.jsxs("div",{className:"bg-white rounded-4 shadow-2xl overflow-hidden d-flex flex-column",style:{width:"900px",height:"85vh",maxWidth:"95%"},onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault(),w(!0)},onDragLeave:e=>{e.preventDefault(),w(!1)},onDrop:e=>{e.preventDefault(),w(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&j(e.dataTransfer.files)},children:[t.jsxs("div",{className:"px-4 py-3 border-bottom d-flex justify-content-between align-items-center bg-white sticky-top",children:[t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("h5",{className:"m-0 fw-bold text-dark ls-tight",children:"Media Library"}),t.jsxs("div",{className:"bg-light rounded-pill px-3 py-1 text-xs fw-bold text-secondary",children:[o.length," Assets"]})]}),t.jsx("button",{className:"btn btn-icon btn-light rounded-circle shadow-sm",onClick:r,style:{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsxs("div",{className:"px-4 py-3 bg-white border-bottom d-flex gap-3 align-items-center",children:[t.jsxs("div",{className:"position-relative flex-grow-1",children:[t.jsx("i",{className:"fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"}),t.jsx("input",{type:"text",className:"form-control rounded-pill ps-5 bg-light border-0",placeholder:"Search your uploads...",value:p,onChange:e=>u(e.target.value),style:{height:"42px"}})]}),t.jsx("input",{type:"file",ref:m,className:"d-none",accept:"image/*",multiple:!0,onChange:e=>{e.target.files&&e.target.files.length>0&&j(e.target.files),e.target.value=""}}),t.jsxs("button",{className:"btn btn-primary rounded-pill px-4 fw-medium d-flex align-items-center gap-2 shadow-sm button-gradient",onClick:()=>m.current.click(),style:{height:"42px"},children:[t.jsx("i",{className:"fas fa-cloud-upload-alt"}),t.jsx("span",{children:"Upload Media"})]})]}),t.jsxs("div",{className:"p-4 overflow-auto grow bg-light custom-scrollbar position-relative ".concat(y?"drop-zone-active":""),children:[y&&t.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:50,backgroundColor:"rgba(255,255,255,0.8)",backdropFilter:"blur(2px)"},children:t.jsxs("div",{className:"text-center text-primary animate-bounce",children:[t.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x mb-3"}),t.jsx("h4",{className:"fw-bold",children:"Drop files to upload"})]})}),0===v.length&&0===f.length?t.jsx("div",{className:"h-100 d-flex flex-column align-items-center justify-content-center text-center opacity-75",onClick:()=>m.current.click(),style:{cursor:"pointer"},children:p?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mb-3 p-3 bg-white rounded-circle shadow-sm text-secondary",children:t.jsx("i",{className:"fas fa-search fs-2"})}),t.jsx("h6",{className:"fw-bold text-dark",children:"No matches found"}),t.jsx("p",{className:"text-secondary small",children:"Try a different search term"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mb-4 text-muted",children:t.jsx("i",{className:"fas fa-cloud-upload-alt fa-4x mb-3 text-primary opacity-50"})}),t.jsx("h6",{className:"fw-bold text-dark mb-2",children:"Library is Empty"}),t.jsx("p",{className:"text-secondary small mb-4",children:"Drag & drop images here or click to browse"})]})}):t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1.25rem"},children:[f.map(e=>t.jsxs("div",{className:"bg-white rounded-3 p-3 border shadow-sm d-flex flex-column justify-content-center position-relative overflow-hidden",style:{aspectRatio:"1"},children:[t.jsx("div",{className:"text-center mb-2",children:t.jsx("i",{className:"fas ".concat("error"===e.status?"fa-exclamation-circle text-danger":"fa-image text-muted"," fs-3")})}),t.jsx("div",{className:"text-xs text-truncate text-center mb-2 fw-medium",children:e.name}),"error"===e.status?t.jsx("div",{className:"text-danger text-xs text-center",children:e.errorMsg}):t.jsx("div",{className:"w-100 bg-light rounded-pill overflow-hidden",style:{height:"6px"},children:t.jsx("div",{className:"bg-primary h-100 transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),"success"===e.status&&t.jsx("div",{className:"position-absolute top-0 end-0 p-1 text-success bg-white rounded-circle m-2 shadow-sm",children:t.jsx("i",{className:"fas fa-check-circle"})})]},e.id)),v.map(e=>{const s=h.has(e.path);return t.jsxs("div",{className:"media-card position-relative bg-white rounded-3 overflow-hidden border ".concat(s?"selected border-primary ring-2 ring-primary ring-opacity-50":"border-light"),style:{aspectRatio:"1",cursor:"pointer",transition:"all 0.2s",transform:s?"scale(0.98)":"scale(1)"},onClick:t=>((e,t)=>{e.stopPropagation();const n=new Set(h);n.has(t.path)?n.delete(t.path):n.add(t.path),b(n)})(t,e),children:[t.jsx("div",{className:"position-absolute top-0 start-0 p-2",style:{zIndex:20},children:t.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center shadow-sm border ".concat(s?"bg-primary border-primary text-white":"bg-white border-secondary"),style:{width:"24px",height:"24px",transition:"all 0.2s"},children:s&&t.jsx("i",{className:"fas fa-check",style:{fontSize:"12px"}})})}),t.jsx("div",{className:"w-100 h-100 p-3 d-flex align-items-center justify-content-center",style:{backgroundColor:"#f8f9fa",backgroundImage:"radial-gradient(#cbd5e1 1px, transparent 1px)",backgroundSize:"10px 10px"},children:t.jsx("img",{src:e.url,alt:e.name,className:"mw-100 mh-100 object-fit-contain shadow-sm rounded-2",onError:e=>{e.target.onerror=null,e.target.src="https://via.placeholder.com/150?text=Error"}})}),t.jsx("div",{className:"media-actions position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",children:t.jsxs("div",{className:"position-absolute top-0 end-0 p-2 d-flex gap-2",style:{zIndex:20},children:[t.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-primary d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:t=>((e,t)=>{e.stopPropagation();const s=t.name,a=s.substring(0,s.lastIndexOf("."))||s;n.fire({title:"Rename File",text:'Enter new name for "'.concat(s,'"'),input:"text",inputValue:a,showCancelButton:!0,confirmButtonText:"Rename",confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",inputValidator:e=>{if(!e)return"You need to write something!"},customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-blue-500 hover:bg-blue-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2",input:"form-control shadow-none border-gray-300 rounded-lg w-75 mx-auto"}}).then(e=>{e.isConfirmed&&x(t.path,e.value)})})(t,e),title:"Rename",children:t.jsx("i",{className:"fas fa-pen",style:{fontSize:"14px"}})}),t.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-danger d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:t=>((e,t)=>{e.stopPropagation(),n.fire({title:"Delete this file?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Delete",cancelButtonText:"Cancel",customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2"}}).then(e=>{if(e.isConfirmed){d(t);const e=new Set(h);e.has(t)&&(e.delete(t),b(e))}})})(t,e.path),title:"Delete",children:t.jsx("i",{className:"fas fa-trash-alt",style:{fontSize:"14px"}})})]})}),t.jsx("div",{className:"position-absolute bottom-0 w-100 bg-white border-top p-2",children:t.jsx("div",{className:"text-truncate text-xs fw-medium text-secondary text-center",children:e.name})})]},e.path)})]})]}),t.jsxs("div",{className:"bg-white border-top px-4 py-3 d-flex justify-content-between align-items-center",children:[t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsxs("small",{className:"text-muted text-xs",children:[h.size," selected"]}),h.size>0&&t.jsxs("button",{className:"btn btn-danger btn-sm rounded-pill px-3 shadow-sm d-flex align-items-center gap-2",onClick:e=>{e.stopPropagation(),n.fire({title:"Delete ".concat(h.size," files?"),text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete",customClass:{popup:"rounded-xl shadow-2xl border-0",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2"}}).then(e=>{e.isConfirmed&&(d(Array.from(h)),b(new Set))})},children:[t.jsx("i",{className:"fas fa-trash-alt"}),t.jsx("span",{children:"Delete Selected"})]})]}),t.jsxs("button",{className:"btn btn-primary rounded-pill px-4 fw-bold shadow-sm ".concat(0===h.size?"disabled opacity-50":"button-gradient"),onClick:()=>{const e=o.filter(e=>h.has(e.path));l(e),b(new Set)},disabled:0===h.size,children:["Insert Selected (",h.size,")"]})]})]})]})}function d({certificate:n,event:s}){const d=n.content_layout||{},x=Array.isArray(d),[m,p]=e.useState(x?d:d.elements||[]),[u,h]=e.useState(!x&&d.canvas?d.canvas:{width:1056,height:816}),[b,f]=e.useState(!x&&d.background?d.background:{x:0,y:0,scale:1}),[g,y]=e.useState(n.certificate_background),[w,v]=e.useState(!1),j=e.useRef(m);j.current=m;const[N,k]=e.useState(new Set),[C,S]=e.useState(!1),[z,M]=e.useState(1),[D,E]=e.useState(!1),[T,B]=e.useState({x:null,y:null}),[I,R]=e.useState(!0),[L,P]=e.useState(!0),[A,F]=e.useState([]),[O,W]=e.useState(!1),Y=()=>{fetch(route("events.certificates.get-media",n.id)).then(e=>e.json()).then(e=>F(e)).catch(e=>console.error("Failed to load media",e))};e.useEffect(()=>{Y()},[]);const X=e.useRef(null),G=e.useRef(null),[_,U]=e.useState([n.content_layout||[]]),[q,H]=e.useState([]),V=()=>{if(_.length>1){const e=_[_.length-1],t=_[_.length-2];H(t=>[e,...t]),U(e=>e.slice(0,-1)),p(t)}},J=(e,t=!0)=>{p(e),t&&(e=>{U(t=>{const n=t[t.length-1];return JSON.stringify(n)===JSON.stringify(e)?t:[...t,e]}),H([])})(e)},K=e.useMemo(()=>0===N.size?null:[...N][N.size-1],[N]),Z=m.find(e=>e.id===K),[Q,$]=e.useState([]),[ee,te]=e.useState(null),[ne,se]=e.useState({enabled:!1,columns:12,margin:40,gutter:20,color:"#FF0000",opacity:.1}),[ae,re]=e.useState(!1),[oe,le]=e.useState(null);e.useEffect(()=>{document.createElement("link")},[]);const ie=e.useMemo(()=>({participant_name:"John Doe",event_title:s.title||"Event Title",date:(new Date).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}),certificate_code:"CERT-SAMPLE-123"}),[s.title]);e.useEffect(()=>{const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Alex+Brush&family=Bebas+Neue&family=Cinzel:wght@400;700&family=Cormorant+Garamond:wght@400;600&family=Great+Vibes&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;600&family=Open+Sans:wght@400;600&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap",e.rel="stylesheet",document.head.appendChild(e);const t=()=>B({x:null,y:null});window.addEventListener("mouseup",t);const n=e=>{te(t=>{if(!t)return null;if(!X.current)return t;const n=X.current.getBoundingClientRect();let s=0;return s="horizontal"===t.type?(e.clientY-n.top)/z:(e.clientX-n.left)/z,{...t,currentPos:s}})},s=e=>{te(e=>{if(!e)return null;const t=e.currentPos<-20;return $(n=>{const s=[...n];return void 0!==e.index&&-1!==e.index?(t?s.splice(e.index,1):s[e.index]={...s[e.index],pos:e.currentPos},s):t?n:[...n,{type:"horizontal"===e.type?"y":"x",pos:e.currentPos}]}),null})};return window.addEventListener("mousemove",n),window.addEventListener("mouseup",s),()=>{document.head.removeChild(e),window.removeEventListener("mouseup",t),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",s)}},[z]);const ce=(e,t,n=-1)=>{if(t.preventDefault(),t.stopPropagation(),!X.current)return;const s=X.current.getBoundingClientRect();let a=e;"y"===e&&(a="horizontal"),"x"===e&&(a="vertical");let r=0;r="horizontal"===a?(t.clientY-s.top)/z:(t.clientX-s.left)/z,te({type:a,currentPos:r,index:n})},de=(e,t)=>{ce(e,t,-1)},xe=e=>{const t=(Array.isArray(e)?e:[e]).map(e=>{const t=e.type,n={id:Date.now()+Math.random(),type:t,x:50+20*Math.random(),y:50+20*Math.random(),...e};return"text"===t||"variable"===t?(n.text=e.text||"New Text",n.fontSize=28,n.color="#1e293b",n.fontWeight="normal",n.fontFamily="'Montserrat', sans-serif",n.textAlign="center"):"qrcode"===t?n.width=100:"shape"===t?(n.width=150,n.height=100,n.color="#0f172a",n.shapeType=e.shapeType||"rectangle"):"line"===t?(n.width=300,n.height=3,n.color="#000000"):"signature"!==t&&"image"!==t||(n.width=200,n.src=e.src||""),n});J([...m,...t]),k(new Set(t.map(e=>e.id)))},me=(e,t={})=>{xe([{type:e,...t}])};e.useEffect(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"z"===e.key&&(e.preventDefault(),V())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[V]);const pe=e=>{const t=m.map(t=>N.has(t.id)?{...t,...e}:t);J(t)},ue=e=>{const t=m.filter(t=>t.id!==e);J(t);const n=new Set(N);n.delete(e),k(n)},he=(e,t)=>{if(!X.current||!G.current)return;const n=X.current.getBoundingClientRect(),s=100/n.width,a=100/n.height,r=e*s,o=t*a;p(e=>e.map(e=>N.has(e.id)?{...e,x:Math.max(0,Math.min(100,e.x+r)),y:Math.max(0,Math.min(100,e.y+o))}:e))},be=(e,t,n,s)=>{if(!X.current)return;const a=X.current.getBoundingClientRect(),r=100/a.width,o=100/a.height;p(a=>a.map(a=>{if(a.id!==e)return a;const l=t/z,i=n/z;let c=a.width||100,d=a.height||100,x=a.x,m=a.y;const p=t/z*r,u=n/z*o;return s.includes("e")&&(c+=l),s.includes("w")&&(c-=l,x+=p),s.includes("s")&&(d+=i),s.includes("n")&&(d-=i,m+=u),{...a,x:x,y:m,width:Math.max(10,c),height:Math.max(10,d)}}))},fe=L?{bgApp:"bg-[#0f172a]",bgPanel:"bg-[#1e293b]",bgInput:"bg-[#1e293b]",border:"border-slate-700",textMain:"text-[#e1e4e5]",textMuted:"text-slate-400",glassHdr:"glass-panel-dark",glassSide:"glass-panel-dark",highlight:"text-info",grid:"grid-bg-dark"}:{bgApp:"bg-slate-50",bgPanel:"bg-white",bgInput:"bg-white",border:"border-slate-200",textMain:"text-slate-700",textMuted:"text-slate-500",glassHdr:"glass-panel-light",glassSide:"glass-panel-light",highlight:"text-success",grid:"grid-bg-light"};return t.jsxs("div",{className:"d-flex flex-column vh-100 ".concat(fe.bgApp," ").concat(fe.textMain," transition-colors duration-300"),style:{fontFamily:"'Inter', sans-serif"},children:[t.jsx(a,{title:"Designer - ".concat(s.title)}),t.jsx("style",{children:"\n                /* Transition for smooth theme switch */\n                .transition-colors { transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease; }\n\n                ::-webkit-scrollbar { width: 6px; height: 6px; }\n                ::-webkit-scrollbar-track { background: transparent; }\n                ::-webkit-scrollbar-thumb { background: ".concat(L?"#334155":"#cbd5e1","; border-radius: 3px; }\n\n                .glass-panel-dark {\n                    background: rgba(30, 41, 59, 0.95); /* More opaque for professional look */\n                    backdrop-filter: blur(12px);\n                    border: 1px solid rgba(255, 255, 255, 0.05);\n                }\n                .glass-panel-light {\n                    background: rgba(255, 255, 255, 0.95);\n                    backdrop-filter: blur(12px);\n                    border: 1px solid rgba(0, 0, 0, 0.05);\n                }\n\n                .grid-bg-dark {\n                    background-image: radial-gradient(rgba(51, 65, 85, 0.4) 1px, transparent 1px);\n                    background-size: 24px 24px;\n                }\n                .grid-bg-light {\n                    background-image: radial-gradient(rgba(148, 163, 184, 0.4) 1px, transparent 1px);\n                    background-size: 24px 24px;\n                }\n\n                .btn-tech {\n                    background: linear-gradient(135deg, ").concat(L?"#06b6d4":"#3b82f6"," 0%, ").concat(L?"#3b82f6":"#2563eb"," 100%);\n                    color: white; border: none;\n                    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);\n                    transition: all 0.2s;\n                }\n                .btn-tech:hover { transform: translateY(-1px); box-shadow: 0 8px 10px -2px rgba(59, 130, 246, 0.4); }\n\n                /* Sidebar Buttons */\n                .sidebar-btn {\n                    transition: all 0.2s;\n                    border: 1px solid #dee2e6;\n                    color: ").concat(L?"#e1e4e5":"#334155",";\n                    background: ").concat(L?"rgba(255, 255, 255, 0.05)":"transparent",";\n                }\n                .sidebar-btn:hover {\n                    background: ").concat(L?"rgba(255, 255, 255, 0.1)":"#f1f5f9","; /* Theme color hover */\n                    border-color: ").concat(fe.border,';\n                    transform: translateX(2px);\n                }\n\n                /* Upload Button */\n                .btn-upload {\n                    background: white; color: #333; border: 1px solid #ddd; transition: all 0.3s;\n                }\n                .btn-upload:hover {\n                    background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);\n                    color: white; border-color: transparent;\n                }\n\n                /* Inputs - "Proper" Style */\n                .form-control-proper {\n                    border-radius: 4px; /* Less rounded */\n                    border: 1px solid ').concat(L?"#475569":"#cbd5e1",";\n                    background-color: ").concat(L?"#0f172a":"#fff","; /* Input distinct bg */\n                    color: ").concat(L?"#fff":"#333",";\n                    padding: 0.375rem 0.75rem;\n                    margin-bottom: 1rem;\n                    font-size: 0.875rem;\n                }\n                .form-control-proper:focus {\n                    border-color: #06b6d4;\n                    color: ").concat(L?"#333":"#000",";\n                    box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);\n                    outline: none;\n                }\n                .form-control-proper:hover {\n                    color: ").concat(L?"#333":"#000",";\n                }\n\n                .form-select-proper {\n                    margin-bottom: 1rem;\n                    border-radius: 4px;\n                    border: 1px solid ").concat(L?"#475569":"#cbd5e1",";\n                    background-color: ").concat(L?"#0f172a":"#fff",";\n                    color: ").concat(L?"#fff":"#333",";\n                    padding: 0.375rem 2rem 0.375rem 0.75rem;\n                    font-size: 0.875rem;\n                }\n            ")}),t.jsxs("header",{className:"px-4 py-3 d-flex justify-content-between align-items-center shadow-sm position-relative ".concat(fe.glassHdr," border-bottom ").concat(fe.border),style:{zIndex:100},children:[t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ".concat(L?"bg-slate-800 text-white":"bg-slate-100 text-dark"),onClick:()=>window.close(),style:{width:36,height:36},children:t.jsx("i",{className:"fas fa-chevron-left"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"fw-bold ls-1 ".concat(L?"text-white":"text-dark"),style:{fontSize:"1.1rem"},children:["CERTIFICATE"," ",t.jsx("span",{className:fe.highlight,children:"STUDIO"})]}),t.jsx("div",{className:"text-xs ".concat(L?"text-white":"text-dark"," fw-medium"),children:s.title})]})]}),t.jsxs("div",{className:"d-flex align-items-center gap-3",children:[t.jsx("button",{className:"btn btn-sm rounded-circle d-flex align-items-center justify-content-center border-0 ".concat(L?"bg-slate-800 text-warning":"bg-slate-200 text-slate-600"),onClick:()=>P(!L),style:{width:32,height:32},children:t.jsx("i",{className:"fas ".concat(L?"fa-sun":"fa-moon")})}),t.jsxs("div",{className:"d-flex align-items-center rounded-pill p-1 border ".concat(fe.border," ").concat(fe.bgInput),children:[t.jsx("button",{className:"btn btn-sm ".concat(L?"text-white":"text-slate-600"," hover-text-primary"),onClick:()=>M(e=>Math.max(.4,e-.1)),children:t.jsx("i",{className:"fas fa-minus"})}),t.jsxs("span",{className:"small px-2 fw-medium ".concat(L?"text-white":"text-slate-800"),style:{minWidth:40,textAlign:"center"},children:[Math.round(100*z),"%"]}),t.jsx("button",{className:"btn btn-sm ".concat(L?"text-white":"text-slate-600"," hover-text-primary"),onClick:()=>M(e=>Math.min(2.5,e+.1)),children:t.jsx("i",{className:"fas fa-plus"})})]}),t.jsx("div",{className:"h-50 border-end ".concat(fe.border," mx-1")}),t.jsxs("div",{className:"d-flex align-items-center rounded-pill px-2 border ".concat(fe.border," me-2 ").concat(fe.bgInput),children:[t.jsx("button",{className:"btn btn-sm ".concat(L?"text-white":"text-slate-600"),onClick:()=>{$([{type:"x",pos:421},{type:"y",pos:297.5}])},title:"Add Center Guides (2x2)",children:t.jsx("i",{className:"fas fa-border-all"})}),t.jsx("button",{className:"btn btn-sm ".concat(L?"text-white":"text-slate-600"),onClick:()=>{$([{type:"x",pos:842/3},{type:"x",pos:842/3*2},{type:"y",pos:595/3},{type:"y",pos:595/3*2}])},title:"Add Thirds Guides (3x3)",children:t.jsx("i",{className:"fas fa-th"})}),t.jsx("button",{className:"btn btn-sm text-danger",onClick:()=>$([]),title:"Clear All Guides",children:t.jsx("i",{className:"fas fa-trash-alt"})})]}),t.jsxs("div",{className:"position-relative me-2",children:[t.jsxs("button",{className:"btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 ".concat(ne.enabled?"bg-primary text-white border-primary":L?"text-white border-slate-600 bg-slate-800":"text-slate-600 border-slate-300 bg-white"),onClick:()=>re(!ae),title:"Configure Layout Columns",children:[t.jsx("i",{className:"fas fa-columns"}),t.jsx("span",{className:"d-none d-md-inline small",children:"Columns"})]}),ae&&t.jsxs("div",{className:"position-absolute top-100 end-0 mt-2 p-3 rounded shadow-lg",onClick:e=>e.stopPropagation(),style:{width:"280px",zIndex:2e3,backgroundColor:L?"#1e293b":"#ffffff",borderColor:L?"#334155":"#e2e8f0",borderWidth:"1px",borderStyle:"solid"},children:[t.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[t.jsx("span",{className:"fw-bold text-sm ".concat(L?"text-white":"text-slate-800"),children:"Layout Grid"}),t.jsxs("div",{className:"form-check form-switch m-0 d-flex align-items-center",children:[t.jsx("input",{className:"form-check-input mt-0",type:"checkbox",checked:ne.enabled,onChange:e=>se(t=>({...t,enabled:e.target.checked})),id:"gridToggle",style:{cursor:"pointer",width:"2.5rem",height:"1.25rem",border:"2px solid rgba(255,255,255,0.2)",backgroundColor:ne.enabled?"#ef4444":"#64748b",backgroundImage:"none"}}),t.jsx("label",{className:"form-check-label ms-2 cursor-pointer small text-muted",htmlFor:"gridToggle",children:ne.enabled?"On":"Off"})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-xs fw-semibold d-block mb-1 ".concat(L?"text-slate-400":"text-slate-500"),children:"Columns (Count)"}),t.jsx("input",{type:"number",className:"form-control form-control-sm",value:ne.columns,onChange:e=>{const t=parseInt(e.target.value);se(e=>({...e,enabled:!0,columns:isNaN(t)?"":Math.max(1,Math.min(24,t))}))},min:"1",max:"24",style:{height:"32px",fontSize:"14px"}})]}),t.jsxs("div",{className:"row g-2 mb-3",children:[t.jsxs("div",{className:"col-6",children:[t.jsx("label",{className:"text-xs fw-semibold d-block mb-1 ".concat(L?"text-slate-400":"text-slate-500"),children:"Margin (px)"}),t.jsx("input",{type:"number",className:"form-control form-control-sm",value:ne.margin,onChange:e=>{const t=parseInt(e.target.value);se(e=>({...e,enabled:!0,margin:isNaN(t)?"":Math.max(0,t)}))},style:{height:"32px",fontSize:"14px"}})]}),t.jsxs("div",{className:"col-6",children:[t.jsx("label",{className:"text-xs fw-semibold d-block mb-1 ".concat(L?"text-slate-400":"text-slate-500"),children:"Gutter (px)"}),t.jsx("input",{type:"number",className:"form-control form-control-sm",value:ne.gutter,onChange:e=>{const t=parseInt(e.target.value);se(e=>({...e,enabled:!0,gutter:isNaN(t)?"":Math.max(0,t)}))},style:{height:"32px",fontSize:"14px"}})]})]}),t.jsxs("div",{className:"mb-1",children:[t.jsxs("div",{className:"d-flex justify-content-between font-sm mb-1",children:[t.jsx("label",{className:"text-xs fw-semibold ".concat(L?"text-slate-400":"text-slate-500"),children:"Opacity"}),t.jsxs("span",{className:"text-xs ".concat(L?"text-slate-400":"text-slate-500"),children:[Math.round(100*ne.opacity),"%"]})]}),t.jsx("input",{type:"range",className:"form-range w-100",min:"0.05",max:"0.5",step:"0.05",value:ne.opacity,onChange:e=>se(t=>({...t,enabled:!0,opacity:parseFloat(e.target.value)})),style:{accentColor:"#ef4444"}})]})]})]}),t.jsx("div",{className:"h-100 mx-3 border-end border-secondary opacity-25"}),t.jsxs("div",{className:"d-flex align-items-center gap-2 me-2",children:[t.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ".concat(L?"bg-slate-800 text-white":"bg-slate-200 text-dark"),onClick:V,disabled:_.length<=1,style:{width:32,height:32},title:"Undo (Ctrl+Z)",children:t.jsx("i",{className:"fas fa-undo"})}),t.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ".concat(L?"bg-slate-800 text-white":"bg-slate-200 text-dark"),onClick:()=>{if(q.length>0){const e=q[0];U(t=>[...t,e]),H(e=>e.slice(1)),p(e)}},disabled:0===q.length,style:{width:32,height:32},title:"Redo (Ctrl+Y)",children:t.jsx("i",{className:"fas fa-redo"})})]}),t.jsx("button",{className:"btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 ".concat(I?"bg-slate-100 text-slate-700":"bg-slate-800 text-white"),onClick:()=>R(!I),title:I?"Collapse Sidebar":"Expand Sidebar",children:t.jsx("i",{className:"fas fa-".concat(I?"chevron-right":"chevron-left"),style:{color:L?"#fff":"#000"}})}),t.jsxs("button",{className:"btn btn-tech rounded-pill px-4 fw-medium d-flex align-items-center gap-2",onClick:()=>{S(!0),r.post(route("events.certificates.update-design",n.id),{content_layout:{elements:m,canvas:u,background:b},image_files:A,certificate_background:g},{onFinish:()=>S(!1),preserveScroll:!0,onSuccess:()=>{le({message:"Design saved successfully!",type:"success"})},onError:e=>{console.error("Save failed:",e);const t=Object.values(e)[0];le({message:"Failed: ".concat(t||"Check console"),type:"error"})}})},disabled:C,children:[C?t.jsx("i",{className:"fas fa-circle-notch fa-spin"}):t.jsx("i",{className:"fas fa-save"}),t.jsx("span",{children:"Save"})]})]})]}),t.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[t.jsxs("aside",{className:"d-flex flex-column ".concat(fe.glassSide," border-end ").concat(fe.border," overflow-auto"),style:{width:"280px"},children:[t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"text-xs fw-bold ".concat(fe.highlight," text-uppercase ls-1 mb-3"),children:[t.jsx("i",{className:"fas fa-layer-group me-1"})," Elements"]}),t.jsxs("div",{className:"d-grid gap-2",children:[t.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>me("text"),children:[t.jsx("i",{className:"fas fa-heading fa-fw opacity-50"})," ",t.jsx("span",{children:"Headline / Text"})]}),t.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>me("line"),children:[t.jsx("i",{className:"fas fa-minus fa-fw opacity-50"})," ",t.jsx("span",{children:"Line Separator"})]}),t.jsxs("div",{className:"d-flex gap-2",children:[t.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("shape",{shapeType:"rectangle"}),children:t.jsx("i",{className:"far fa-square fa-lg"})}),t.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("shape",{shapeType:"circle"}),children:t.jsx("i",{className:"far fa-circle fa-lg"})}),t.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("qrcode"),children:t.jsx("i",{className:"fas fa-qrcode fa-lg"})})]})]})]}),t.jsxs("div",{className:"p-4 border-top ".concat(fe.border),children:[t.jsxs("div",{className:"text-xs fw-bold ".concat(fe.highlight," text-uppercase ls-1 mb-3"),children:[t.jsx("i",{className:"fas fa-file-alt me-1"})," Page Setup"]}),t.jsxs("div",{className:"d-flex gap-2 mb-3",children:[t.jsx("button",{className:"btn btn-sm w-50 ".concat(u.width>u.height?"btn-tech":L?"btn-outline-secondary":"btn-outline-dark"),onClick:()=>h({width:1056,height:816}),children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsxs("span",{children:[t.jsx("i",{className:"far fa-file-image me-1"})," ","Landscape"]}),t.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"1056 x 816 px"})]})}),t.jsx("button",{className:"btn btn-sm w-50 ".concat(u.width<u.height?"btn-tech":L?"btn-outline-secondary":"btn-outline-dark"),onClick:()=>h({width:816,height:1056}),children:t.jsxs("div",{className:"d-flex flex-column align-items-center",children:[t.jsxs("span",{children:[t.jsx("i",{className:"far fa-file me-1"})," ","Portrait"]}),t.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"816 x 1056 px"})]})})]}),t.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[t.jsx("span",{className:"text-xs",children:"Background Edit"}),t.jsx("div",{className:"form-check form-switch",children:t.jsx("input",{className:"form-check-input",type:"checkbox",checked:w,onChange:()=>v(!w)})})]}),w&&t.jsxs("div",{className:"mb-2",children:[t.jsxs("label",{className:"text-xs text-muted mb-1",children:["Scale: ",Math.round(100*b.scale),"%"]}),t.jsx("input",{type:"range",className:"form-range",min:"0.5",max:"3",step:"0.1",value:b.scale,onChange:e=>f(t=>({...t,scale:parseFloat(e.target.value)}))})]})]}),t.jsxs("div",{className:"p-4 border-top ".concat(fe.border),children:[t.jsxs("div",{className:"text-xs fw-bold ".concat(fe.highlight," text-uppercase ls-1 mb-3"),children:[t.jsx("i",{className:"fas fa-code-branch me-1"})," ","Variables"]}),t.jsx("div",{className:"d-grid gap-2",children:["Participant Name","Event Title","Date","Certificate Code"].map((e,n)=>t.jsxs("button",{className:"sidebar-btn w-100 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>me("text",{text:"{{ ".concat(e.toLowerCase().replace(" ","_")," }}")}),children:[t.jsx("div",{className:"d-flex align-items-center justify-content-center ".concat(L?"bg-slate-700 text-slate-300":"bg-slate-200 text-dark"," me-3 rounded-1"),style:{minWidth:"40px",height:"22px",fontSize:"10px",fontWeight:"bold"},children:"VAR"}),t.jsx("span",{className:"fw-medium",children:e})]},e))})]}),t.jsx("div",{className:"p-4 border-top ".concat(fe.border," flex-grow-1"),children:t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:t.jsxs("div",{className:"text-xs fw-bold ".concat(fe.highlight," text-uppercase ls-1"),children:[t.jsx("i",{className:"fas fa-photo-film me-1"})," ","Media Files"]})}),t.jsxs("button",{className:"sidebar-btn w-100 mb-2 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>W(!0),children:[t.jsx("i",{className:"fas fa-images fa-lg me-2"}),t.jsx("span",{className:"fw-medium",children:"Manage Media Library"})]}),t.jsxs("div",{className:"text-xs text-center ".concat(fe.textMuted," mb-3"),children:[A.length," files available"]})]})})]}),t.jsxs("div",{className:"flex-grow-1 d-flex flex-column overflow-hidden position-relative",children:[t.jsxs("div",{className:"d-flex",style:{height:"24px",flexShrink:0,zIndex:50,background:L?"#1e293b":"#f1f5f9"},children:[t.jsx("div",{style:{width:"24px",flexShrink:0,borderRight:"1px solid ".concat(L?"#334155":"#cbd5e1"),borderBottom:"1px solid ".concat(L?"#334155":"#cbd5e1")}}),t.jsx("div",{className:"flex-grow-1 position-relative overflow-hidden",children:t.jsx(i,{type:"horizontal",zoom:z,offset:T.rulerX||0,theme:{bg:L?"#1e293b":"#f1f5f9",borderColor:L?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:L?"#94a3b8":"#64748b"},onDragStart:de})})]}),t.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[t.jsx("div",{style:{width:"24px",flexShrink:0,zIndex:50,overflow:"hidden",background:L?"#1e293b":"#f1f5f9"},children:t.jsx(i,{type:"vertical",zoom:z,offset:T.rulerY||0,theme:{bg:L?"#1e293b":"#f1f5f9",borderColor:L?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:L?"#94a3b8":"#64748b"},onDragStart:de})}),t.jsxs("main",{className:"flex-grow-1 position-relative d-flex align-items-center justify-content-center overflow-hidden ".concat(fe.grid),id:"canvas-scroll-container",onClick:()=>k(new Set),style:{overflow:"auto"},children:[null!==T.x&&t.jsx("div",{className:"position-absolute h-100",style:{left:"".concat(T.x,"%"),width:"1px",background:L?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),null!==T.y&&t.jsx("div",{className:"position-absolute w-100",style:{top:"".concat(T.y,"%"),height:"1px",background:L?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),ee&&t.jsx("div",{className:"position-absolute",style:{zIndex:101,pointerEvents:"none",background:"#10b981",..."horizontal"===ee.type?{left:0,right:0,top:0,height:"1px",transform:"translateY(".concat(T.rulerY+ee.currentPos*z,"px)")}:{top:0,bottom:0,left:0,width:"1px",transform:"translateX(".concat(T.rulerX+ee.currentPos*z,"px)")}},children:t.jsx("span",{className:"position-absolute bg-success text-white px-1 text-xs",style:{top:2,left:2},children:Math.round(ee.currentPos)})}),t.jsx("div",{className:"overflow-auto w-100 h-100 d-flex align-items-center justify-content-center p-5",ref:G,onScroll:()=>{if(X.current&&G.current){const e=X.current.getBoundingClientRect(),t=G.current.getBoundingClientRect();B(n=>({...n,rulerX:e.left-t.left,rulerY:e.top-t.top}))}},children:t.jsxs("div",{ref:X,className:"position-relative bg-white shadow-sm transition-all duration-300",style:{width:"".concat(u.width,"px"),height:"".concat(u.height,"px"),minWidth:"".concat(u.width,"px"),minHeight:"".concat(u.height,"px"),transform:"scale(".concat(z,")"),transformOrigin:"center center",boxShadow:L?"0 0 50px rgba(0,0,0,0.5)":"0 0 30px rgba(0,0,0,0.1)",overflow:"hidden"},onDoubleClick:e=>{var t;(e.target===X.current||(null==(t=e.target.classList)?void 0:t.contains("bg-layer")))&&(v(!w),le({message:w?"Background Locked":"Background Edit Mode: Drag to move",type:"info"}))},children:[t.jsx("div",{className:"bg-layer position-absolute w-100 h-100 start-0 top-0 ".concat(w?"cursor-move":""),style:{zIndex:0,backgroundImage:g?'url("/storage/'.concat(g,'")'):"none",backgroundSize:"cover",backgroundPosition:"center",transform:"translate(".concat(b.x,"px, ").concat(b.y,"px) scale(").concat(b.scale,")"),transformOrigin:"center center",opacity:1,pointerEvents:w?"auto":"none"},onMouseDown:e=>{if(!w)return;e.preventDefault(),e.stopPropagation();const t=e.clientX,n=e.clientY,s=b.x,a=b.y,r=e=>{const r=(e.clientX-t)/z,o=(e.clientY-n)/z;f(e=>({...e,x:s+r,y:a+o}))},o=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",o)}}),w&&t.jsx("div",{className:"position-absolute top-0 start-0 m-2 badge bg-warning text-dark z-index-10",children:"Background Edit Mode"}),ne.enabled&&t.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100",style:{zIndex:89,pointerEvents:"none",padding:"0 ".concat(ne.margin,"px"),display:"flex",gap:"".concat((ne.margin,0),"px")},children:t.jsx("div",{className:"w-100 h-100 d-flex",style:{gap:"".concat(ne.gutter,"px"),pointerEvents:"none"},children:[...Array(ne.columns)].map((e,n)=>t.jsx("div",{className:"flex-grow-1 h-100",style:{backgroundColor:ne.color,opacity:ne.opacity,pointerEvents:"none"}},n))})}),Q.map((e,n)=>t.jsx("div",{className:"position-absolute guide-line",onMouseDown:t=>ce(e.type,t,n),style:{zIndex:90,pointerEvents:"auto",cursor:"y"===e.type?"row-resize":"col-resize",..."y"===e.type?{left:0,right:0,top:"".concat(e.pos-2,"px"),height:"5px",borderTop:"2px solid transparent",borderBottom:"2px solid transparent",backgroundColor:"transparent"}:{top:0,bottom:0,left:"".concat(e.pos-2,"px"),width:"5px",borderLeft:"2px solid transparent",borderRight:"2px solid transparent",backgroundColor:"transparent"}},children:t.jsx("div",{style:{width:"y"===e.type?"100%":"1px",height:"y"===e.type?"1px":"100%",backgroundColor:"#06b6d4",position:"absolute",top:"y"===e.type?"2px":0,left:"y"===e.type?0:"2px",boxShadow:"0 0 2px rgba(255,255,255,0.5)"}})},n)),m.map(e=>t.jsx(l,{element:e,previewData:ie,isSelected:N.has(e.id),onMouseDown:t=>{if(t.shiftKey){const t=new Set(N);t.has(e.id)?t.delete(e.id):t.add(e.id),k(t)}else N.has(e.id)||k(new Set([e.id]))},onDrag:he,onResize:be,onDragStop:()=>J(j.current),onDelete:ue},e.id))]})})]})]})]}),t.jsx("aside",{className:"".concat(fe.glassSide," border-start ").concat(fe.border," d-flex flex-column shadow-lg z-20 transition-all duration-300 ease-in-out"),style:{width:I?"300px":"0px",overflow:"hidden",opacity:I?1:0},children:Z&&N.size>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-4 ".concat(fe.bgPanel," border-bottom ").concat(fe.border," text-center"),style:{minWidth:"300px"},children:t.jsx("div",{className:"text-xs fw-bold ".concat(fe.highlight," text-uppercase ls-1"),children:"Properties"})}),t.jsxs("div",{className:"p-4 flex-grow-1 overflow-auto",style:{minWidth:"300px"},children:[("text"===Z.type||"variable"===Z.type)&&t.jsxs("div",{className:"vstack gap-5",children:[" ",t.jsxs("div",{children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted," text-uppercase mb-2"),children:"Content"}),t.jsx("textarea",{className:"form-control-proper w-100",rows:"3",value:Z.text,onChange:e=>pe({text:e.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted," text-uppercase mb-2"),children:"Typography"}),t.jsxs("div",{className:"vstack gap-3",children:[t.jsx("select",{className:"form-select-proper w-100",value:Z.fontFamily,onChange:e=>pe({fontFamily:e.target.value}),children:[{label:"Cinzel",value:"'Cinzel', serif"},{label:"Montserrat",value:"'Montserrat', sans-serif"},{label:"Playfair Display",value:"'Playfair Display', serif"},{label:"Great Vibes",value:"'Great Vibes', cursive"},{label:"Lato",value:"'Lato', sans-serif"},{label:"Pinyon Script",value:"'Pinyon Script', cursive"},{label:"Cormorant Garamond",value:"'Cormorant Garamond', serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Bebas Neue",value:"'Bebas Neue', display"},{label:"Alex Brush",value:"'Alex Brush', cursive"}].map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))}),t.jsxs("div",{className:"row g-2 align-items-center",children:[t.jsx("div",{className:"col-8",children:t.jsx("div",{className:"input-group input-group-sm",children:t.jsx("input",{type:"number",className:"form-control-proper w-100",value:Z.fontSize,onChange:e=>pe({fontSize:parseInt(e.target.value)}),placeholder:"Size"})})}),t.jsx("div",{className:"col-4",children:t.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"31px",width:"100%",position:"relative",backgroundColor:Z.color},children:t.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",opacity:0},value:Z.color,onChange:e=>pe({color:e.target.value})})})})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted," text-uppercase mb-2"),children:"Style"}),t.jsxs("div",{className:"btn-group w-100 mb-3",children:[t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("bold"===Z.fontWeight?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({fontWeight:"bold"===Z.fontWeight?"normal":"bold"}),children:t.jsx("i",{className:"fas fa-bold"})}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("italic"===Z.fontStyle?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({fontStyle:"italic"===Z.fontStyle?"normal":"italic"}),children:t.jsx("i",{className:"fas fa-italic"})}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("underline"===Z.textDecoration?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({textDecoration:"underline"===Z.textDecoration?"none":"underline"}),children:t.jsx("i",{className:"fas fa-underline"})})]}),t.jsxs("div",{className:"btn-group w-100",children:[t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("left"===Z.textAlign?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({textAlign:"left"}),children:t.jsx("i",{className:"fas fa-align-left"})}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("center"===Z.textAlign?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({textAlign:"center"}),children:t.jsx("i",{className:"fas fa-align-center"})}),t.jsx("button",{className:"btn btn-sm btn-outline-secondary ".concat(L?"text-white":""," ").concat("right"===Z.textAlign?L?"btn-tech border-0":"bg-info border-info text-white":""),onClick:()=>pe({textAlign:"right"}),children:t.jsx("i",{className:"fas fa-align-right"})})]})]})]}),("line"===Z.type||"shape"===Z.type)&&t.jsxs("div",{className:"vstack gap-3",children:[t.jsxs("div",{className:"row g-2",children:[t.jsxs("div",{className:"col-6",children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted),children:"Width"}),t.jsx("input",{type:"number",className:"form-control-proper w-100",value:Z.width,onChange:e=>pe({width:parseInt(e.target.value)})})]}),t.jsxs("div",{className:"col-6",children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted),children:"line"===Z.type?"Thickness":"Height"}),t.jsx("input",{type:"number",className:"form-control-proper w-100",value:Z.height,onChange:e=>pe({height:parseInt(e.target.value)})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs fw-bold ".concat(fe.textMuted," text-uppercase mb-1"),children:"Color"}),t.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"36px",width:"100%",position:"relative"},children:t.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",border:"none"},value:Z.color,onChange:e=>pe({color:e.target.value})})})]})]})]}),t.jsxs("div",{className:"p-4 border-top ".concat(fe.border," mt-auto ").concat(fe.bgPanel),children:[t.jsxs("button",{className:"btn btn-outline-secondary w-100 mb-2 rounded-2 ".concat(L?"text-white border-slate-600":""),onClick:()=>{const e=m.filter(e=>N.has(e.id)).map(e=>({...e,id:Date.now()+Math.random(),x:e.x+2,y:e.y+2}));J([...m,...e]),k(new Set(e.map(e=>e.id)))},children:[t.jsx("i",{className:"far fa-clone me-2"})," ","Duplicate"]}),t.jsxs("button",{className:"btn btn-outline-danger w-100 rounded-2",onClick:()=>{p(m.filter(e=>!N.has(e.id))),k(new Set)},children:[t.jsx("i",{className:"far fa-trash-alt me-2"})," ","Delete"]})]})]}):t.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 ".concat(fe.textMuted," p-4 text-center"),children:[t.jsx("i",{className:"fas fa-mouse-pointer fa-3x mb-3 opacity-25"}),t.jsx("div",{className:"text-sm",children:"Select an element to resize or edit"})]})})]}),t.jsx(o,{show:!!oe,message:null==oe?void 0:oe.message,type:"error"===(null==oe?void 0:oe.type)?"danger":null==oe?void 0:oe.type,onClose:()=>le(null)}),t.jsx(c,{show:O,onClose:()=>W(!1),files:A,onSelect:e=>{Array.isArray(e)?xe(e.map(e=>({type:"image",src:e.url,name:e.name,path:e.path}))):xe([{type:"image",src:e.url,name:e.name,path:e.path}]),W(!1)},uploadUrl:route("events.certificates.upload-media",n.id),onUploadSuccess:()=>Y(),onDelete:async e=>{var t;const s=Array.isArray(e),a=s?{paths:e}:{path:e},r=s?e:[e];try{(await fetch(route("events.certificates.delete-media",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":null==(t=document.querySelector('meta[name="csrf-token"]'))?void 0:t.getAttribute("content")},body:JSON.stringify(a)})).ok?(F(e=>e.filter(e=>!r.includes(e.path))),p(e=>e.filter(e=>"image"!==e.type&&"signature"!==e.type||!r.some(t=>e.src.includes(t)))),g&&r.some(e=>g.includes(e))&&y(null),le({message:"File(s) deleted successfully",type:"success"})):(console.error("Delete failed"),le({message:"Delete failed",type:"danger"}))}catch(o){console.error("Error deleting media:",o),le({message:"Error deleting media",type:"danger"})}},onRename:async(e,t)=>{var s;try{const a=await fetch(route("events.certificates.rename-media",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":null==(s=document.querySelector('meta[name="csrf-token"]'))?void 0:s.getAttribute("content")},body:JSON.stringify({old_path:e,new_name:t})});if(a.ok){const t=await a.json();F(n=>n.map(n=>n.path===e?t:n)),le({message:"File renamed successfully",type:"success"})}else{const e=await a.json();le({message:e.error||"Rename failed",type:"danger"})}}catch(a){console.error(a),le({message:"Rename error",type:"danger"})}}})]})}export{d as default};
