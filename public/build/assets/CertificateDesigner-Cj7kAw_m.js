import{r as i,j as e,a as Fe,H as Ye,b as Ge}from"./app-8jlO-GOR.js";import{T as Xe}from"./Toast-BZmhIwvk.js";import{S as oe}from"./sweetalert2.esm.all-BQxta0Da.js";/* empty css            */function Oe({element:n,isSelected:D,previewData:C,onMouseDown:P,onDrag:M,onResize:A,onDragStop:p,onDelete:U}){const E=i.useRef(null),$=i.useRef(!1),R=i.useRef(!1),y=i.useRef({x:0,y:0}),j=i.useRef(null);i.useEffect(()=>()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",N)},[]);const S=m=>{m.preventDefault();const F=m.clientX,v=m.clientY,T=F-y.current.x,L=v-y.current.y;R.current?(A(n.id,T,L,j.current),y.current={x:F,y:v}):$.current&&(M(T,L),y.current={x:F,y:v})},N=()=>{($.current||R.current)&&p&&p(n.id),$.current=!1,R.current=!1,j.current=null,document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",N)},h=m=>{m.stopPropagation(),!m.target.dataset.handle&&(P(m,n.id),$.current=!0,R.current=!1,y.current={x:m.clientX,y:m.clientY},document.addEventListener("mousemove",S),document.addEventListener("mouseup",N))},Y=(m,F)=>{m.stopPropagation(),m.preventDefault(),R.current=!0,$.current=!1,j.current=F,y.current={x:m.clientX,y:m.clientY},document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},H=m=>{m.stopPropagation(),m.preventDefault(),U(n.id)},_={position:"absolute",left:`${n.x}%`,top:`${n.y}%`,cursor:$.current?"grabbing":"grab",border:D?"1px solid #06b6d4":"1px solid transparent",boxShadow:D?"0 0 0 1px rgba(6, 182, 212, 1)":"none",userSelect:"none",transform:"translate(0, 0)",zIndex:D?50:10,transition:$.current||R.current?"none":"border 0.2s, box-shadow 0.2s"},w=()=>{if(!D||!["shape","image","signature","qrcode","text","variable"].includes(n.type))return null;const F={width:"10px",height:"10px",background:"#fff",border:"1px solid #7c3aed",borderRadius:"50%",position:"absolute",zIndex:51},v=[{id:"se",cursor:"nwse-resize",style:{bottom:"-5px",right:"-5px"}},{id:"sw",cursor:"nesw-resize",style:{bottom:"-5px",left:"-5px"}},{id:"ne",cursor:"nesw-resize",style:{top:"-5px",right:"-5px"}},{id:"nw",cursor:"nwse-resize",style:{top:"-5px",left:"-5px"}},{id:"e",cursor:"ew-resize",style:{top:"50%",right:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",backgroundColor:"#7c3aed",background:"#fff",border:"1px solid #7c3aed"}},{id:"w",cursor:"ew-resize",style:{top:"50%",left:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",background:"#fff",border:"1px solid #7c3aed"}}];return e.jsx(e.Fragment,{children:v.map(T=>e.jsx("div",{"data-handle":T.id,onMouseDown:L=>Y(L,T.id),style:{...F,...T.style,cursor:T.cursor}},T.id))})},q=()=>{const m={width:"100%",height:"100%"};if(n.type==="qrcode")return e.jsx("div",{style:{...m,width:n.width,height:n.width,background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"9px",color:"#000",textAlign:"center",padding:"5px",borderRadius:"8px"},children:e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 p-1 bg-white border",children:[e.jsx("i",{className:"fas fa-qrcode fa-3x mb-1"}),e.jsx("div",{style:{fontSize:"0.6em",textTransform:"uppercase",fontWeight:"bold"},children:"SCAN ME"})]})});if(n.type==="shape")return e.jsx("div",{style:{...m,width:n.width,height:n.height,backgroundColor:n.color||"#000000",borderRadius:n.shapeType==="circle"?"50%":"4px"}});if(n.type==="line")return e.jsx("div",{style:{width:n.width,height:n.height,backgroundColor:n.color||"#000000"}});if(n.type==="image"||n.type==="signature")return e.jsx("div",{style:{width:n.width},children:e.jsx("img",{src:n.src,style:{width:"100%",pointerEvents:"none"}})});let F=n.text;C&&!D&&(n.type==="text"||n.type==="variable")&&Object.keys(C).forEach(T=>{const L=new RegExp(`{{\\s*${T}\\s*}}`,"gi");F=F.replace(L,C[T])});const v=n.width&&n.width>0;return e.jsx("div",{style:{fontSize:`${n.fontSize||14}px`,color:n.color||"#000000",fontWeight:n.fontWeight||"normal",fontFamily:n.fontFamily||"Arial",fontStyle:n.fontStyle||"normal",textDecoration:n.textDecoration||"none",textAlign:n.textAlign||"left",width:v?`${n.width}px`:"auto",whiteSpace:v?"normal":"nowrap",wordWrap:v?"break-word":"normal",padding:"4px 8px",lineHeight:1.2,border:D&&v?"1px dashed #cbd5e1":"none"},children:F})};return e.jsxs("div",{ref:E,onMouseDown:h,onClick:m=>m.stopPropagation(),style:_,className:"group draggable-item",children:[D&&e.jsx("div",{onClick:H,className:"position-absolute rounded-circle bg-danger text-white shadow-sm border",style:{width:"15px",height:"15px",top:"-18px",right:"-16px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",cursor:"pointer",zIndex:60,padding:"0",margin:"0"},title:"Delete",children:e.jsx("i",{className:"fas fa-times"})}),q(),w()]})}const je=({type:n="horizontal",length:D=3e3,zoom:C=1,theme:P,offset:M=0,onDragStart:A})=>{const p=n==="horizontal",U=100,E=10,$=i.useMemo(()=>{const S=[];for(let h=0;h<=3e3;h+=E)S.push({pos:h,isMajor:h%U===0,label:h});return S},[]),R=p?{width:"100%",height:"24px",borderBottom:`1px solid ${P?.borderColor||"#ccc"}`,backgroundColor:P?.bg||"#f8f9fa",overflow:"hidden"}:{width:"24px",height:"100%",borderRight:`1px solid ${P?.borderColor||"#ccc"}`,backgroundColor:P?.bg||"#f8f9fa",overflow:"hidden"},y={position:"absolute",[p?"left":"top"]:M,[p?"top":"left"]:0,transformOrigin:"0 0"},j=S=>{S.preventDefault(),A&&A(n,S)};return e.jsx("div",{className:`ruler-${n} d-flex position-relative user-select-none`,style:R,onMouseDown:j,children:e.jsx("div",{style:y,children:$.map(({pos:S,isMajor:N,label:h})=>e.jsx("div",{className:"position-absolute",style:{[p?"left":"top"]:`${S*C}px`,[p?"top":"left"]:0,width:p?"1px":N?"12px":"6px",height:p?N?"12px":"6px":"1px",backgroundColor:P?.tickColor||"#94a3b8"},children:N&&e.jsx("span",{className:"position-absolute fs-10",style:{fontSize:"9px",color:P?.textColor||"#64748b",fontWeight:"600",[p?"left":"top"]:"4px",[p?"top":"left"]:"2px",transform:p?"none":"rotate(-90deg) translateX(-100%)",transformOrigin:"top left",whiteSpace:"nowrap"},children:h})},S))})})};function We({show:n,onClose:D,files:C=[],onSelect:P,uploadUrl:M,onUploadSuccess:A,onDelete:p,onRename:U}){const E=i.useRef(null),[$,R]=i.useState(""),[y,j]=i.useState(new Set),[S,N]=i.useState([]),[h,Y]=i.useState(!1),H=i.useMemo(()=>$?C.filter(s=>s.name.toLowerCase().includes($.toLowerCase())):C,[C,$]);if(i.useEffect(()=>{n||(j(new Set),N([]))},[n]),!n)return null;const _=async s=>{const u=new FormData;u.append("file",s.file);try{N(g=>g.map(f=>f.id===s.id?{...f,status:"uploading"}:f));const l=await Fe.post(M,u,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:g=>{const f=Math.round(g.loaded*100/g.total);N(W=>W.map(V=>V.id===s.id?{...V,progress:f}:V))}});N(g=>g.map(f=>f.id===s.id?{...f,status:"success",progress:100}:f)),A(),setTimeout(()=>{N(g=>g.filter(f=>f.id!==s.id))},3e3)}catch(l){console.error("Upload failed",l);let g="Upload failed";l.response?.data?.message?g=l.response.data.message:l.response?.status===422?g="Validation error":l.message&&(g=l.message),N(f=>f.map(W=>W.id===s.id?{...W,status:"error",errorMsg:g}:W))}},w=s=>{const u=[];Array.from(s).forEach(l=>{if(l.size>2*1024*1024){oe.fire({icon:"error",title:"File too large",text:`${l.name} exceeds 2MB limit.`,customClass:{popup:"rounded-xl shadow-2xl border-0"}});return}const f={id:Math.random().toString(36).substring(7),file:l,name:l.name,progress:0,status:"pending",errorMsg:null};u.push(f),_(f)}),u.length>0&&N(l=>[...l,...u])},q=s=>{s.preventDefault(),Y(!0)},m=s=>{s.preventDefault(),Y(!1)},F=s=>{s.preventDefault(),Y(!1),s.dataTransfer.files&&s.dataTransfer.files.length>0&&w(s.dataTransfer.files)},v=(s,u)=>{s.stopPropagation();const l=new Set(y);l.has(u.path)?l.delete(u.path):l.add(u.path),j(l)},T=()=>{const s=C.filter(u=>y.has(u.path));P(s),j(new Set)},L=(s,u)=>{s.stopPropagation();const l=u.name,g=l.substring(0,l.lastIndexOf("."))||l;oe.fire({title:"Rename File",text:`Enter new name for "${l}"`,input:"text",inputValue:g,showCancelButton:!0,confirmButtonText:"Rename",confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",inputValidator:f=>{if(!f)return"You need to write something!"},customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-blue-500 hover:bg-blue-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2",input:"form-control shadow-none border-gray-300 rounded-lg w-75 mx-auto"}}).then(f=>{f.isConfirmed&&U(u.path,f.value)})},ie=(s,u)=>{s.stopPropagation(),oe.fire({title:"Delete this file?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Delete",cancelButtonText:"Cancel",customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2"}}).then(l=>{if(l.isConfirmed){p(u);const g=new Set(y);g.has(u)&&(g.delete(u),j(g))}})};return e.jsxs("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:3e3,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:D,children:[e.jsx("style",{children:`
                .swal2-container { z-index: 10000 !important; }
                /* Overlay Styles */
                .media-actions { opacity: 0; transition: opacity 0.2s ease; background-color: rgba(0, 0, 0, 0.4); }
                .media-card:hover .media-actions { opacity: 1; }
                .media-card.selected .media-actions { opacity: 1; background-color: rgba(0, 0, 0, 0.1); }
                
                .media-card { transition: all 0.2s ease; }
                .media-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
                .custom-scrollbar::-webkit-scrollbar { width: 6px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
                .button-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); border: none; }
                .text-shadow { text-shadow: 0 1px 2px rgba(0,0,0,0.3); }
                .drop-zone-active { border: 2px dashed #6366f1; background-color: rgba(99, 102, 241, 0.05); }
            `}),e.jsxs("div",{className:"bg-white rounded-4 shadow-2xl overflow-hidden d-flex flex-column",style:{width:"900px",height:"85vh",maxWidth:"95%"},onClick:s=>s.stopPropagation(),onDragOver:q,onDragLeave:m,onDrop:F,children:[e.jsxs("div",{className:"px-4 py-3 border-bottom d-flex justify-content-between align-items-center bg-white sticky-top",children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("h5",{className:"m-0 fw-bold text-dark ls-tight",children:"Media Library"}),e.jsxs("div",{className:"bg-light rounded-pill px-3 py-1 text-xs fw-bold text-secondary",children:[C.length," Assets"]})]}),e.jsx("button",{className:"btn btn-icon btn-light rounded-circle shadow-sm",onClick:D,style:{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"px-4 py-3 bg-white border-bottom d-flex gap-3 align-items-center",children:[e.jsxs("div",{className:"position-relative flex-grow-1",children:[e.jsx("i",{className:"fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"}),e.jsx("input",{type:"text",className:"form-control rounded-pill ps-5 bg-light border-0",placeholder:"Search your uploads...",value:$,onChange:s=>R(s.target.value),style:{height:"42px"}})]}),e.jsx("input",{type:"file",ref:E,className:"d-none",accept:"image/*",multiple:!0,onChange:s=>{s.target.files&&s.target.files.length>0&&w(s.target.files),s.target.value=""}}),e.jsxs("button",{className:"btn btn-primary rounded-pill px-4 fw-medium d-flex align-items-center gap-2 shadow-sm button-gradient",onClick:()=>E.current.click(),style:{height:"42px"},children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"}),e.jsx("span",{children:"Upload Media"})]})]}),e.jsxs("div",{className:`p-4 overflow-auto grow bg-light custom-scrollbar position-relative ${h?"drop-zone-active":""}`,children:[h&&e.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:50,backgroundColor:"rgba(255,255,255,0.8)",backdropFilter:"blur(2px)"},children:e.jsxs("div",{className:"text-center text-primary animate-bounce",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x mb-3"}),e.jsx("h4",{className:"fw-bold",children:"Drop files to upload"})]})}),H.length===0&&S.length===0?e.jsx("div",{className:"h-100 d-flex flex-column align-items-center justify-content-center text-center opacity-75",onClick:()=>E.current.click(),style:{cursor:"pointer"},children:$?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3 p-3 bg-white rounded-circle shadow-sm text-secondary",children:e.jsx("i",{className:"fas fa-search fs-2"})}),e.jsx("h6",{className:"fw-bold text-dark",children:"No matches found"}),e.jsx("p",{className:"text-secondary small",children:"Try a different search term"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 text-muted",children:e.jsx("i",{className:"fas fa-cloud-upload-alt fa-4x mb-3 text-primary opacity-50"})}),e.jsx("h6",{className:"fw-bold text-dark mb-2",children:"Library is Empty"}),e.jsx("p",{className:"text-secondary small mb-4",children:"Drag & drop images here or click to browse"})]})}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1.25rem"},children:[S.map(s=>e.jsxs("div",{className:"bg-white rounded-3 p-3 border shadow-sm d-flex flex-column justify-content-center position-relative overflow-hidden",style:{aspectRatio:"1"},children:[e.jsx("div",{className:"text-center mb-2",children:e.jsx("i",{className:`fas ${s.status==="error"?"fa-exclamation-circle text-danger":"fa-image text-muted"} fs-3`})}),e.jsx("div",{className:"text-xs text-truncate text-center mb-2 fw-medium",children:s.name}),s.status==="error"?e.jsx("div",{className:"text-danger text-xs text-center",children:s.errorMsg}):e.jsx("div",{className:"w-100 bg-light rounded-pill overflow-hidden",style:{height:"6px"},children:e.jsx("div",{className:"bg-primary h-100 transition-all duration-300",style:{width:`${s.progress}%`}})}),s.status==="success"&&e.jsx("div",{className:"position-absolute top-0 end-0 p-1 text-success bg-white rounded-circle m-2 shadow-sm",children:e.jsx("i",{className:"fas fa-check-circle"})})]},s.id)),H.map(s=>{const u=y.has(s.path);return e.jsxs("div",{className:`media-card position-relative bg-white rounded-3 overflow-hidden border ${u?"selected border-primary ring-2 ring-primary ring-opacity-50":"border-light"}`,style:{aspectRatio:"1",cursor:"pointer",transition:"all 0.2s",transform:u?"scale(0.98)":"scale(1)"},onClick:l=>v(l,s),children:[e.jsx("div",{className:"position-absolute top-0 start-0 p-2",style:{zIndex:20},children:e.jsx("div",{className:`rounded-circle d-flex align-items-center justify-content-center shadow-sm border ${u?"bg-primary border-primary text-white":"bg-white border-secondary"}`,style:{width:"24px",height:"24px",transition:"all 0.2s"},children:u&&e.jsx("i",{className:"fas fa-check",style:{fontSize:"12px"}})})}),e.jsx("div",{className:"w-100 h-100 p-3 d-flex align-items-center justify-content-center",style:{backgroundColor:"#f8f9fa",backgroundImage:"radial-gradient(#cbd5e1 1px, transparent 1px)",backgroundSize:"10px 10px"},children:e.jsx("img",{src:s.url,alt:s.name,className:"mw-100 mh-100 object-fit-contain shadow-sm rounded-2",onError:l=>{l.target.onerror=null,l.target.src="https://via.placeholder.com/150?text=Error"}})}),e.jsx("div",{className:"media-actions position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",children:e.jsxs("div",{className:"position-absolute top-0 end-0 p-2 d-flex gap-2",style:{zIndex:20},children:[e.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-primary d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:l=>L(l,s),title:"Rename",children:e.jsx("i",{className:"fas fa-pen",style:{fontSize:"14px"}})}),e.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-danger d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:l=>ie(l,s.path),title:"Delete",children:e.jsx("i",{className:"fas fa-trash-alt",style:{fontSize:"14px"}})})]})}),e.jsx("div",{className:"position-absolute bottom-0 w-100 bg-white border-top p-2",children:e.jsx("div",{className:"text-truncate text-xs fw-medium text-secondary text-center",children:s.name})})]},s.path)})]})]}),e.jsxs("div",{className:"bg-white border-top px-4 py-3 d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsxs("small",{className:"text-muted text-xs",children:[y.size," selected"]}),y.size>0&&e.jsxs("button",{className:"btn btn-danger btn-sm rounded-pill px-3 shadow-sm d-flex align-items-center gap-2",onClick:s=>{s.stopPropagation(),oe.fire({title:`Delete ${y.size} files?`,text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete",customClass:{popup:"rounded-xl shadow-2xl border-0",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2"}}).then(u=>{u.isConfirmed&&(p(Array.from(y)),j(new Set))})},children:[e.jsx("i",{className:"fas fa-trash-alt"}),e.jsx("span",{children:"Delete Selected"})]})]}),e.jsxs("button",{className:`btn btn-primary rounded-pill px-4 fw-bold shadow-sm ${y.size===0?"disabled opacity-50":"button-gradient"}`,onClick:T,disabled:y.size===0,children:["Insert Selected (",y.size,")"]})]})]})]})}function Ve({certificate:n,event:D}){const C=n.content_layout||{},P=Array.isArray(C),[M,A]=i.useState(P?C:C.elements||[]),[p,U]=i.useState(!P&&C.canvas?C.canvas:{width:1056,height:816}),[E,$]=i.useState(!P&&C.background?C.background:{x:0,y:0,scale:1}),[R,y]=i.useState(n.certificate_background),[j,S]=i.useState(!1),N=i.useRef(M);N.current=M;const[h,Y]=i.useState(new Set),[H,_]=i.useState(!1),[w,q]=i.useState(1),[m,F]=i.useState(!1),[v,T]=i.useState({x:null,y:null}),[L,ie]=i.useState(!0),[s,u]=i.useState(!0),[l,g]=i.useState([]),[f,W]=i.useState(!1),V=()=>{fetch(route("events.certificates.get-media",n.id)).then(t=>t.json()).then(t=>g(t)).catch(t=>console.error("Failed to load media",t))};i.useEffect(()=>{V()},[]);const X=i.useRef(null),te=i.useRef(null),[K,le]=i.useState([n.content_layout||[]]),[de,ce]=i.useState([]),ve=t=>{le(a=>{const o=a[a.length-1];return JSON.stringify(o)===JSON.stringify(t)?a:[...a,t]}),ce([])},xe=()=>{if(K.length>1){const t=K[K.length-1],a=K[K.length-2];ce(o=>[t,...o]),le(o=>o.slice(0,-1)),A(a)}},Ne=()=>{if(de.length>0){const t=de[0];le(a=>[...a,t]),ce(a=>a.slice(1)),A(t)}},Q=(t,a=!0)=>{A(t),a&&ve(t)},ke=[{label:"Cinzel",value:"'Cinzel', serif"},{label:"Montserrat",value:"'Montserrat', sans-serif"},{label:"Playfair Display",value:"'Playfair Display', serif"},{label:"Great Vibes",value:"'Great Vibes', cursive"},{label:"Lato",value:"'Lato', sans-serif"},{label:"Pinyon Script",value:"'Pinyon Script', cursive"},{label:"Cormorant Garamond",value:"'Cormorant Garamond', serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Bebas Neue",value:"'Bebas Neue', display"},{label:"Alex Brush",value:"'Alex Brush', cursive"}],Ce=i.useMemo(()=>h.size===0?null:[...h][h.size-1],[h]),b=M.find(t=>t.id===Ce),[Se,se]=i.useState([]),[Z,ue]=i.useState(null),[I,ee]=i.useState({enabled:!1,columns:12,margin:40,gutter:20,color:"#FF0000",opacity:.1}),[ge,$e]=i.useState(!1),[ae,O]=i.useState(null);i.useEffect(()=>{document.createElement("link")},[]);const ze=i.useMemo(()=>({participant_name:"John Doe",event_title:D.title||"Event Title",date:new Date().toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}),certificate_code:"CERT-SAMPLE-123"}),[D.title]);i.useEffect(()=>{const t=document.createElement("link");t.href="https://fonts.googleapis.com/css2?family=Alex+Brush&family=Bebas+Neue&family=Cinzel:wght@400;700&family=Cormorant+Garamond:wght@400;600&family=Great+Vibes&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;600&family=Open+Sans:wght@400;600&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap",t.rel="stylesheet",document.head.appendChild(t);const a=()=>T({x:null,y:null});window.addEventListener("mouseup",a);const o=x=>{ue(r=>{if(!r)return null;if(!X.current)return r;const z=X.current.getBoundingClientRect();let B=0;return r.type==="horizontal"?B=(x.clientY-z.top)/w:B=(x.clientX-z.left)/w,{...r,currentPos:B}})},c=x=>{ue(r=>{if(!r)return null;const z=r.currentPos<-20;return se(B=>{const k=[...B];return r.index!==void 0&&r.index!==-1?(z?k.splice(r.index,1):k[r.index]={...k[r.index],pos:r.currentPos},k):z?B:[...B,{type:r.type==="horizontal"?"y":"x",pos:r.currentPos}]}),null})};return window.addEventListener("mousemove",o),window.addEventListener("mouseup",c),()=>{document.head.removeChild(t),window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",c)}},[w]);const fe=(t,a,o=-1)=>{if(a.preventDefault(),a.stopPropagation(),!X.current)return;const c=X.current.getBoundingClientRect();let x=t;t==="y"&&(x="horizontal"),t==="x"&&(x="vertical");let r=0;x==="horizontal"?r=(a.clientY-c.top)/w:r=(a.clientX-c.left)/w,ue({type:x,currentPos:r,index:o})},be=(t,a)=>{fe(t,a,-1)},pe=t=>{const o=(Array.isArray(t)?t:[t]).map(c=>{const x=c.type,r={id:Date.now()+Math.random(),type:x,x:50+Math.random()*20,y:50+Math.random()*20,...c};return x==="text"||x==="variable"?(r.text=c.text||"New Text",r.fontSize=28,r.color="#1e293b",r.fontWeight="normal",r.fontFamily="'Montserrat', sans-serif",r.textAlign="center"):x==="qrcode"?r.width=100:x==="shape"?(r.width=150,r.height=100,r.color="#0f172a",r.shapeType=c.shapeType||"rectangle"):x==="line"?(r.width=300,r.height=3,r.color="#000000"):(x==="signature"||x==="image")&&(r.width=200,r.src=c.src||""),r});Q([...M,...o]),Y(new Set(o.map(c=>c.id)))},J=(t,a={})=>{pe([{type:t,...a}])};i.useEffect(()=>{const t=a=>{(a.metaKey||a.ctrlKey)&&a.key==="z"&&(a.preventDefault(),xe())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[xe]);const G=t=>{const a=M.map(o=>h.has(o.id)?{...o,...t}:o);Q(a)},Me=t=>{const a=M.filter(c=>c.id!==t);Q(a);const o=new Set(h);o.delete(t),Y(o)},De=()=>{const t=M.filter(a=>h.has(a.id)).map(a=>({...a,id:Date.now()+Math.random(),x:a.x+2,y:a.y+2}));Q([...M,...t]),Y(new Set(t.map(a=>a.id)))},Ee=(t,a)=>{if(!X.current||!te.current)return;const o=X.current.getBoundingClientRect(),c=100/o.width,x=100/o.height,r=t*c,z=a*x;A(B=>B.map(k=>h.has(k.id)?{...k,x:Math.max(0,Math.min(100,k.x+r)),y:Math.max(0,Math.min(100,k.y+z))}:k))},Re=(t,a,o,c)=>{if(!X.current)return;const x=X.current.getBoundingClientRect(),r=100/x.width,z=100/x.height;A(B=>B.map(k=>{if(k.id!==t)return k;const ne=a/w,re=o/w;let he=k.width||100,me=k.height||100,ye=k.x,we=k.y;const Pe=a/w*r,Ae=o/w*z;return c.includes("e")&&(he+=ne),c.includes("w")&&(he-=ne,ye+=Pe),c.includes("s")&&(me+=re),c.includes("n")&&(me-=re,we+=Ae),{...k,x:ye,y:we,width:Math.max(10,he),height:Math.max(10,me)}}))},Te=t=>{if(!j)return;t.preventDefault(),t.stopPropagation();const a=t.clientX,o=t.clientY,c=E.x,x=E.y,r=B=>{const k=(B.clientX-a)/w,ne=(B.clientY-o)/w;$(re=>({...re,x:c+k,y:x+ne}))},z=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",z)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",z)},Ie=async t=>{const a=Array.isArray(t),o=a?{paths:t}:{path:t},c=a?t:[t];try{(await fetch(route("events.certificates.delete-media",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify(o)})).ok?(g(r=>r.filter(z=>!c.includes(z.path))),A(r=>r.filter(z=>z.type!=="image"&&z.type!=="signature"?!0:!c.some(B=>z.src.includes(B)))),R&&c.some(r=>R.includes(r))&&y(null),O({message:"File(s) deleted successfully",type:"success"})):(console.error("Delete failed"),O({message:"Delete failed",type:"danger"}))}catch(x){console.error("Error deleting media:",x),O({message:"Error deleting media",type:"danger"})}},Be=async(t,a)=>{try{const o=await fetch(route("events.certificates.rename-media",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({old_path:t,new_name:a})});if(o.ok){const c=await o.json();g(x=>x.map(r=>r.path===t?c:r)),O({message:"File renamed successfully",type:"success"})}else{const c=await o.json();O({message:c.error||"Rename failed",type:"danger"})}}catch(o){console.error(o),O({message:"Rename error",type:"danger"})}},Le=()=>{_(!0),Ge.post(route("events.certificates.update-design",n.id),{content_layout:{elements:M,canvas:p,background:E},image_files:l,certificate_background:R},{onFinish:()=>_(!1),preserveScroll:!0,onSuccess:()=>{O({message:"Design saved successfully!",type:"success"})},onError:t=>{console.error("Save failed:",t);const a=Object.values(t)[0];O({message:`Failed: ${a||"Check console"}`,type:"error"})}})},d=s?{bgApp:"bg-[#0f172a]",bgPanel:"bg-[#1e293b]",bgInput:"bg-[#1e293b]",border:"border-slate-700",textMain:"text-[#e1e4e5]",textMuted:"text-slate-400",glassHdr:"glass-panel-dark",glassSide:"glass-panel-dark",highlight:"text-info",grid:"grid-bg-dark"}:{bgApp:"bg-slate-50",bgPanel:"bg-white",bgInput:"bg-white",border:"border-slate-200",textMain:"text-slate-700",textMuted:"text-slate-500",glassHdr:"glass-panel-light",glassSide:"glass-panel-light",highlight:"text-success",grid:"grid-bg-light"};return e.jsxs("div",{className:`d-flex flex-column vh-100 ${d.bgApp} ${d.textMain} transition-colors duration-300`,style:{fontFamily:"'Inter', sans-serif"},children:[e.jsx(Ye,{title:`Designer - ${D.title}`}),e.jsx("style",{children:`
                /* Transition for smooth theme switch */
                .transition-colors { transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease; }

                ::-webkit-scrollbar { width: 6px; height: 6px; }
                ::-webkit-scrollbar-track { background: transparent; }
                ::-webkit-scrollbar-thumb { background: ${s?"#334155":"#cbd5e1"}; border-radius: 3px; }

                .glass-panel-dark {
                    background: rgba(30, 41, 59, 0.95); /* More opaque for professional look */
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(255, 255, 255, 0.05);
                }
                .glass-panel-light {
                    background: rgba(255, 255, 255, 0.95);
                    backdrop-filter: blur(12px);
                    border: 1px solid rgba(0, 0, 0, 0.05);
                }

                .grid-bg-dark {
                    background-image: radial-gradient(rgba(51, 65, 85, 0.4) 1px, transparent 1px);
                    background-size: 24px 24px;
                }
                .grid-bg-light {
                    background-image: radial-gradient(rgba(148, 163, 184, 0.4) 1px, transparent 1px);
                    background-size: 24px 24px;
                }

                .btn-tech {
                    background: linear-gradient(135deg, ${s?"#06b6d4":"#3b82f6"} 0%, ${s?"#3b82f6":"#2563eb"} 100%);
                    color: white; border: none;
                    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
                    transition: all 0.2s;
                }
                .btn-tech:hover { transform: translateY(-1px); box-shadow: 0 8px 10px -2px rgba(59, 130, 246, 0.4); }

                /* Sidebar Buttons */
                .sidebar-btn {
                    transition: all 0.2s;
                    border: 1px solid #dee2e6;
                    color: ${s?"#e1e4e5":"#334155"};
                    background: ${s?"rgba(255, 255, 255, 0.05)":"transparent"};
                }
                .sidebar-btn:hover {
                    background: ${s?"rgba(255, 255, 255, 0.1)":"#f1f5f9"}; /* Theme color hover */
                    border-color: ${d.border};
                    transform: translateX(2px);
                }

                /* Upload Button */
                .btn-upload {
                    background: white; color: #333; border: 1px solid #ddd; transition: all 0.3s;
                }
                .btn-upload:hover {
                    background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
                    color: white; border-color: transparent;
                }

                /* Inputs - "Proper" Style */
                .form-control-proper {
                    border-radius: 4px; /* Less rounded */
                    border: 1px solid ${s?"#475569":"#cbd5e1"};
                    background-color: ${s?"#0f172a":"#fff"}; /* Input distinct bg */
                    color: ${s?"#fff":"#333"};
                    padding: 0.375rem 0.75rem;
                    margin-bottom: 1rem;
                    font-size: 0.875rem;
                }
                .form-control-proper:focus {
                    border-color: #06b6d4;
                    color: ${s?"#333":"#000"};
                    box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);
                    outline: none;
                }
                .form-control-proper:hover {
                    color: ${s?"#333":"#000"};
                }

                .form-select-proper {
                    margin-bottom: 1rem;
                    border-radius: 4px;
                    border: 1px solid ${s?"#475569":"#cbd5e1"};
                    background-color: ${s?"#0f172a":"#fff"};
                    color: ${s?"#fff":"#333"};
                    padding: 0.375rem 2rem 0.375rem 0.75rem;
                    font-size: 0.875rem;
                }
            `}),e.jsxs("header",{className:`px-4 py-3 d-flex justify-content-between align-items-center shadow-sm position-relative ${d.glassHdr} border-bottom ${d.border}`,style:{zIndex:100},children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("button",{className:`btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ${s?"bg-slate-800 text-white":"bg-slate-100 text-dark"}`,onClick:()=>window.close(),style:{width:36,height:36},children:e.jsx("i",{className:"fas fa-chevron-left"})}),e.jsxs("div",{children:[e.jsxs("div",{className:`fw-bold ls-1 ${s?"text-white":"text-dark"}`,style:{fontSize:"1.1rem"},children:["CERTIFICATE"," ",e.jsx("span",{className:d.highlight,children:"STUDIO"})]}),e.jsx("div",{className:`text-xs ${s?"text-white":"text-dark"} fw-medium`,children:D.title})]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("button",{className:`btn btn-sm rounded-circle d-flex align-items-center justify-content-center border-0 ${s?"bg-slate-800 text-warning":"bg-slate-200 text-slate-600"}`,onClick:()=>u(!s),style:{width:32,height:32},children:e.jsx("i",{className:`fas ${s?"fa-sun":"fa-moon"}`})}),e.jsxs("div",{className:`d-flex align-items-center rounded-pill p-1 border ${d.border} ${d.bgInput}`,children:[e.jsx("button",{className:`btn btn-sm ${s?"text-white":"text-slate-600"} hover-text-primary`,onClick:()=>q(t=>Math.max(.4,t-.1)),children:e.jsx("i",{className:"fas fa-minus"})}),e.jsxs("span",{className:`small px-2 fw-medium ${s?"text-white":"text-slate-800"}`,style:{minWidth:40,textAlign:"center"},children:[Math.round(w*100),"%"]}),e.jsx("button",{className:`btn btn-sm ${s?"text-white":"text-slate-600"} hover-text-primary`,onClick:()=>q(t=>Math.min(2.5,t+.1)),children:e.jsx("i",{className:"fas fa-plus"})})]}),e.jsx("div",{className:`h-50 border-end ${d.border} mx-1`}),e.jsxs("div",{className:`d-flex align-items-center rounded-pill px-2 border ${d.border} me-2 ${d.bgInput}`,children:[e.jsx("button",{className:`btn btn-sm ${s?"text-white":"text-slate-600"}`,onClick:()=>{se([{type:"x",pos:842/2},{type:"y",pos:595/2}])},title:"Add Center Guides (2x2)",children:e.jsx("i",{className:"fas fa-border-all"})}),e.jsx("button",{className:`btn btn-sm ${s?"text-white":"text-slate-600"}`,onClick:()=>{se([{type:"x",pos:842/3},{type:"x",pos:842/3*2},{type:"y",pos:595/3},{type:"y",pos:595/3*2}])},title:"Add Thirds Guides (3x3)",children:e.jsx("i",{className:"fas fa-th"})}),e.jsx("button",{className:"btn btn-sm text-danger",onClick:()=>se([]),title:"Clear All Guides",children:e.jsx("i",{className:"fas fa-trash-alt"})})]}),e.jsxs("div",{className:"position-relative me-2",children:[e.jsxs("button",{className:`btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 ${I.enabled?"bg-primary text-white border-primary":s?"text-white border-slate-600 bg-slate-800":"text-slate-600 border-slate-300 bg-white"}`,onClick:()=>$e(!ge),title:"Configure Layout Columns",children:[e.jsx("i",{className:"fas fa-columns"}),e.jsx("span",{className:"d-none d-md-inline small",children:"Columns"})]}),ge&&e.jsxs("div",{className:"position-absolute top-100 end-0 mt-2 p-3 rounded shadow-lg",onClick:t=>t.stopPropagation(),style:{width:"280px",zIndex:2e3,backgroundColor:s?"#1e293b":"#ffffff",borderColor:s?"#334155":"#e2e8f0",borderWidth:"1px",borderStyle:"solid"},children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("span",{className:`fw-bold text-sm ${s?"text-white":"text-slate-800"}`,children:"Layout Grid"}),e.jsxs("div",{className:"form-check form-switch m-0 d-flex align-items-center",children:[e.jsx("input",{className:"form-check-input mt-0",type:"checkbox",checked:I.enabled,onChange:t=>ee(a=>({...a,enabled:t.target.checked})),id:"gridToggle",style:{cursor:"pointer",width:"2.5rem",height:"1.25rem",border:"2px solid rgba(255,255,255,0.2)",backgroundColor:I.enabled?"#ef4444":"#64748b",backgroundImage:"none"}}),e.jsx("label",{className:"form-check-label ms-2 cursor-pointer small text-muted",htmlFor:"gridToggle",children:I.enabled?"On":"Off"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:`text-xs fw-semibold d-block mb-1 ${s?"text-slate-400":"text-slate-500"}`,children:"Columns (Count)"}),e.jsx("input",{type:"number",className:"form-control form-control-sm",value:I.columns,onChange:t=>{const a=parseInt(t.target.value);ee(o=>({...o,enabled:!0,columns:isNaN(a)?"":Math.max(1,Math.min(24,a))}))},min:"1",max:"24",style:{height:"32px",fontSize:"14px"}})]}),e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{className:`text-xs fw-semibold d-block mb-1 ${s?"text-slate-400":"text-slate-500"}`,children:"Margin (px)"}),e.jsx("input",{type:"number",className:"form-control form-control-sm",value:I.margin,onChange:t=>{const a=parseInt(t.target.value);ee(o=>({...o,enabled:!0,margin:isNaN(a)?"":Math.max(0,a)}))},style:{height:"32px",fontSize:"14px"}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{className:`text-xs fw-semibold d-block mb-1 ${s?"text-slate-400":"text-slate-500"}`,children:"Gutter (px)"}),e.jsx("input",{type:"number",className:"form-control form-control-sm",value:I.gutter,onChange:t=>{const a=parseInt(t.target.value);ee(o=>({...o,enabled:!0,gutter:isNaN(a)?"":Math.max(0,a)}))},style:{height:"32px",fontSize:"14px"}})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsxs("div",{className:"d-flex justify-content-between font-sm mb-1",children:[e.jsx("label",{className:`text-xs fw-semibold ${s?"text-slate-400":"text-slate-500"}`,children:"Opacity"}),e.jsxs("span",{className:`text-xs ${s?"text-slate-400":"text-slate-500"}`,children:[Math.round(I.opacity*100),"%"]})]}),e.jsx("input",{type:"range",className:"form-range w-100",min:"0.05",max:"0.5",step:"0.05",value:I.opacity,onChange:t=>ee(a=>({...a,enabled:!0,opacity:parseFloat(t.target.value)})),style:{accentColor:"#ef4444"}})]})]})]}),e.jsx("div",{className:"h-100 mx-3 border-end border-secondary opacity-25"}),e.jsxs("div",{className:"d-flex align-items-center gap-2 me-2",children:[e.jsx("button",{className:`btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ${s?"bg-slate-800 text-white":"bg-slate-200 text-dark"}`,onClick:xe,disabled:K.length<=1,style:{width:32,height:32},title:"Undo (Ctrl+Z)",children:e.jsx("i",{className:"fas fa-undo"})}),e.jsx("button",{className:`btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center ${s?"bg-slate-800 text-white":"bg-slate-200 text-dark"}`,onClick:Ne,disabled:de.length===0,style:{width:32,height:32},title:"Redo (Ctrl+Y)",children:e.jsx("i",{className:"fas fa-redo"})})]}),e.jsx("button",{className:`btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 ${L?"bg-slate-100 text-slate-700":"bg-slate-800 text-white"}`,onClick:()=>ie(!L),title:L?"Collapse Sidebar":"Expand Sidebar",children:e.jsx("i",{className:`fas fa-${L?"chevron-right":"chevron-left"}`,style:{color:s?"#fff":"#000"}})}),e.jsxs("button",{className:"btn btn-tech rounded-pill px-4 fw-medium d-flex align-items-center gap-2",onClick:Le,disabled:H,children:[H?e.jsx("i",{className:"fas fa-circle-notch fa-spin"}):e.jsx("i",{className:"fas fa-save"}),e.jsx("span",{children:"Save"})]})]})]}),e.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[e.jsxs("aside",{className:`d-flex flex-column ${d.glassSide} border-end ${d.border} overflow-auto`,style:{width:"280px"},children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:`text-xs fw-bold ${d.highlight} text-uppercase ls-1 mb-3`,children:[e.jsx("i",{className:"fas fa-layer-group me-1"})," Elements"]}),e.jsxs("div",{className:"d-grid gap-2",children:[e.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>J("text"),children:[e.jsx("i",{className:"fas fa-heading fa-fw opacity-50"})," ",e.jsx("span",{children:"Headline / Text"})]}),e.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>J("line"),children:[e.jsx("i",{className:"fas fa-minus fa-fw opacity-50"})," ",e.jsx("span",{children:"Line Separator"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>J("shape",{shapeType:"rectangle"}),children:e.jsx("i",{className:"far fa-square fa-lg"})}),e.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>J("shape",{shapeType:"circle"}),children:e.jsx("i",{className:"far fa-circle fa-lg"})}),e.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>J("qrcode"),children:e.jsx("i",{className:"fas fa-qrcode fa-lg"})})]})]})]}),e.jsxs("div",{className:`p-4 border-top ${d.border}`,children:[e.jsxs("div",{className:`text-xs fw-bold ${d.highlight} text-uppercase ls-1 mb-3`,children:[e.jsx("i",{className:"fas fa-file-alt me-1"})," Page Setup"]}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{className:`btn btn-sm w-50 ${p.width>p.height?"btn-tech":s?"btn-outline-secondary":"btn-outline-dark"}`,onClick:()=>U({width:1056,height:816}),children:e.jsxs("div",{className:"d-flex flex-column align-items-center",children:[e.jsxs("span",{children:[e.jsx("i",{className:"far fa-file-image me-1"})," ","Landscape"]}),e.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"1056 x 816 px"})]})}),e.jsx("button",{className:`btn btn-sm w-50 ${p.width<p.height?"btn-tech":s?"btn-outline-secondary":"btn-outline-dark"}`,onClick:()=>U({width:816,height:1056}),children:e.jsxs("div",{className:"d-flex flex-column align-items-center",children:[e.jsxs("span",{children:[e.jsx("i",{className:"far fa-file me-1"})," ","Portrait"]}),e.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"816 x 1056 px"})]})})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"text-xs",children:"Background Edit"}),e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:j,onChange:()=>S(!j)})})]}),j&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("label",{className:"text-xs text-muted mb-1",children:["Scale: ",Math.round(E.scale*100),"%"]}),e.jsx("input",{type:"range",className:"form-range",min:"0.5",max:"3",step:"0.1",value:E.scale,onChange:t=>$(a=>({...a,scale:parseFloat(t.target.value)}))})]})]}),e.jsxs("div",{className:`p-4 border-top ${d.border}`,children:[e.jsxs("div",{className:`text-xs fw-bold ${d.highlight} text-uppercase ls-1 mb-3`,children:[e.jsx("i",{className:"fas fa-code-branch me-1"})," ","Variables"]}),e.jsx("div",{className:"d-grid gap-2",children:["Participant Name","Event Title","Date","Certificate Code"].map((t,a)=>e.jsxs("button",{className:"sidebar-btn w-100 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>J("text",{text:`{{ ${t.toLowerCase().replace(" ","_")} }}`}),children:[e.jsx("div",{className:`d-flex align-items-center justify-content-center ${s?"bg-slate-700 text-slate-300":"bg-slate-200 text-dark"} me-3 rounded-1`,style:{minWidth:"40px",height:"22px",fontSize:"10px",fontWeight:"bold"},children:"VAR"}),e.jsx("span",{className:"fw-medium",children:t})]},t))})]}),e.jsx("div",{className:`p-4 border-top ${d.border} flex-grow-1`,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:e.jsxs("div",{className:`text-xs fw-bold ${d.highlight} text-uppercase ls-1`,children:[e.jsx("i",{className:"fas fa-photo-film me-1"})," ","Media Files"]})}),e.jsxs("button",{className:"sidebar-btn w-100 mb-2 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>W(!0),children:[e.jsx("i",{className:"fas fa-images fa-lg me-2"}),e.jsx("span",{className:"fw-medium",children:"Manage Media Library"})]}),e.jsxs("div",{className:`text-xs text-center ${d.textMuted} mb-3`,children:[l.length," files available"]})]})})]}),e.jsxs("div",{className:"flex-grow-1 d-flex flex-column overflow-hidden position-relative",children:[e.jsxs("div",{className:"d-flex",style:{height:"24px",flexShrink:0,zIndex:50,background:s?"#1e293b":"#f1f5f9"},children:[e.jsx("div",{style:{width:"24px",flexShrink:0,borderRight:`1px solid ${s?"#334155":"#cbd5e1"}`,borderBottom:`1px solid ${s?"#334155":"#cbd5e1"}`}}),e.jsx("div",{className:"flex-grow-1 position-relative overflow-hidden",children:e.jsx(je,{type:"horizontal",zoom:w,offset:v.rulerX||0,theme:{bg:s?"#1e293b":"#f1f5f9",borderColor:s?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:s?"#94a3b8":"#64748b"},onDragStart:be})})]}),e.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[e.jsx("div",{style:{width:"24px",flexShrink:0,zIndex:50,overflow:"hidden",background:s?"#1e293b":"#f1f5f9"},children:e.jsx(je,{type:"vertical",zoom:w,offset:v.rulerY||0,theme:{bg:s?"#1e293b":"#f1f5f9",borderColor:s?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:s?"#94a3b8":"#64748b"},onDragStart:be})}),e.jsxs("main",{className:`flex-grow-1 position-relative d-flex align-items-center justify-content-center overflow-hidden ${d.grid}`,id:"canvas-scroll-container",onClick:()=>Y(new Set),style:{overflow:"auto"},children:[v.x!==null&&e.jsx("div",{className:"position-absolute h-100",style:{left:`${v.x}%`,width:"1px",background:s?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),v.y!==null&&e.jsx("div",{className:"position-absolute w-100",style:{top:`${v.y}%`,height:"1px",background:s?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),Z&&e.jsx("div",{className:"position-absolute",style:{zIndex:101,pointerEvents:"none",background:"#10b981",...Z.type==="horizontal"?{left:0,right:0,top:0,height:"1px",transform:`translateY(${v.rulerY+Z.currentPos*w}px)`}:{top:0,bottom:0,left:0,width:"1px",transform:`translateX(${v.rulerX+Z.currentPos*w}px)`}},children:e.jsx("span",{className:"position-absolute bg-success text-white px-1 text-xs",style:{top:2,left:2},children:Math.round(Z.currentPos)})}),e.jsx("div",{className:"overflow-auto w-100 h-100 d-flex align-items-center justify-content-center p-5",ref:te,onScroll:()=>{if(X.current&&te.current){const t=X.current.getBoundingClientRect(),a=te.current.getBoundingClientRect();T(o=>({...o,rulerX:t.left-a.left,rulerY:t.top-a.top}))}},children:e.jsxs("div",{ref:X,className:"position-relative bg-white shadow-sm transition-all duration-300",style:{width:`${p.width}px`,height:`${p.height}px`,minWidth:`${p.width}px`,minHeight:`${p.height}px`,transform:`scale(${w})`,transformOrigin:"center center",boxShadow:s?"0 0 50px rgba(0,0,0,0.5)":"0 0 30px rgba(0,0,0,0.1)",overflow:"hidden"},onDoubleClick:t=>{(t.target===X.current||t.target.classList?.contains("bg-layer"))&&(S(!j),O({message:j?"Background Locked":"Background Edit Mode: Drag to move",type:"info"}))},children:[e.jsx("div",{className:`bg-layer position-absolute w-100 h-100 start-0 top-0 ${j?"cursor-move":""}`,style:{zIndex:0,backgroundImage:R?`url("/storage/${R}")`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`translate(${E.x}px, ${E.y}px) scale(${E.scale})`,transformOrigin:"center center",opacity:1,pointerEvents:j?"auto":"none"},onMouseDown:Te}),j&&e.jsx("div",{className:"position-absolute top-0 start-0 m-2 badge bg-warning text-dark z-index-10",children:"Background Edit Mode"}),I.enabled&&e.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100",style:{zIndex:89,pointerEvents:"none",padding:`0 ${I.margin}px`,display:"flex",gap:`${I.margin>0,0}px`},children:e.jsx("div",{className:"w-100 h-100 d-flex",style:{gap:`${I.gutter}px`,pointerEvents:"none"},children:[...Array(I.columns)].map((t,a)=>e.jsx("div",{className:"flex-grow-1 h-100",style:{backgroundColor:I.color,opacity:I.opacity,pointerEvents:"none"}},a))})}),Se.map((t,a)=>e.jsx("div",{className:"position-absolute guide-line",onMouseDown:o=>fe(t.type,o,a),style:{zIndex:90,pointerEvents:"auto",cursor:t.type==="y"?"row-resize":"col-resize",...t.type==="y"?{left:0,right:0,top:`${t.pos-2}px`,height:"5px",borderTop:"2px solid transparent",borderBottom:"2px solid transparent",backgroundColor:"transparent"}:{top:0,bottom:0,left:`${t.pos-2}px`,width:"5px",borderLeft:"2px solid transparent",borderRight:"2px solid transparent",backgroundColor:"transparent"}},children:e.jsx("div",{style:{width:t.type==="y"?"100%":"1px",height:t.type==="y"?"1px":"100%",backgroundColor:"#06b6d4",position:"absolute",top:t.type==="y"?"2px":0,left:t.type==="y"?0:"2px",boxShadow:"0 0 2px rgba(255,255,255,0.5)"}})},a)),M.map(t=>e.jsx(Oe,{element:t,previewData:ze,isSelected:h.has(t.id),onMouseDown:a=>{if(a.shiftKey){const o=new Set(h);o.has(t.id)?o.delete(t.id):o.add(t.id),Y(o)}else h.has(t.id)||Y(new Set([t.id]))},onDrag:Ee,onResize:Re,onDragStop:()=>Q(N.current),onDelete:Me},t.id))]})})]})]})]}),e.jsx("aside",{className:`${d.glassSide} border-start ${d.border} d-flex flex-column shadow-lg z-20 transition-all duration-300 ease-in-out`,style:{width:L?"300px":"0px",overflow:"hidden",opacity:L?1:0},children:b&&h.size>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`p-4 ${d.bgPanel} border-bottom ${d.border} text-center`,style:{minWidth:"300px"},children:e.jsx("div",{className:`text-xs fw-bold ${d.highlight} text-uppercase ls-1`,children:"Properties"})}),e.jsxs("div",{className:"p-4 flex-grow-1 overflow-auto",style:{minWidth:"300px"},children:[(b.type==="text"||b.type==="variable")&&e.jsxs("div",{className:"vstack gap-5",children:[" ",e.jsxs("div",{children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted} text-uppercase mb-2`,children:"Content"}),e.jsx("textarea",{className:"form-control-proper w-100",rows:"3",value:b.text,onChange:t=>G({text:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted} text-uppercase mb-2`,children:"Typography"}),e.jsxs("div",{className:"vstack gap-3",children:[e.jsx("select",{className:"form-select-proper w-100",value:b.fontFamily,onChange:t=>G({fontFamily:t.target.value}),children:ke.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsxs("div",{className:"row g-2 align-items-center",children:[e.jsx("div",{className:"col-8",children:e.jsx("div",{className:"input-group input-group-sm",children:e.jsx("input",{type:"number",className:"form-control-proper w-100",value:b.fontSize,onChange:t=>G({fontSize:parseInt(t.target.value)}),placeholder:"Size"})})}),e.jsx("div",{className:"col-4",children:e.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"31px",width:"100%",position:"relative",backgroundColor:b.color},children:e.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",opacity:0},value:b.color,onChange:t=>G({color:t.target.value})})})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted} text-uppercase mb-2`,children:"Style"}),e.jsxs("div",{className:"btn-group w-100 mb-3",children:[e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.fontWeight==="bold"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({fontWeight:b.fontWeight==="bold"?"normal":"bold"}),children:e.jsx("i",{className:"fas fa-bold"})}),e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.fontStyle==="italic"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({fontStyle:b.fontStyle==="italic"?"normal":"italic"}),children:e.jsx("i",{className:"fas fa-italic"})}),e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.textDecoration==="underline"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({textDecoration:b.textDecoration==="underline"?"none":"underline"}),children:e.jsx("i",{className:"fas fa-underline"})})]}),e.jsxs("div",{className:"btn-group w-100",children:[e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.textAlign==="left"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({textAlign:"left"}),children:e.jsx("i",{className:"fas fa-align-left"})}),e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.textAlign==="center"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({textAlign:"center"}),children:e.jsx("i",{className:"fas fa-align-center"})}),e.jsx("button",{className:`btn btn-sm btn-outline-secondary ${s?"text-white":""} ${b.textAlign==="right"?s?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>G({textAlign:"right"}),children:e.jsx("i",{className:"fas fa-align-right"})})]})]})]}),(b.type==="line"||b.type==="shape")&&e.jsxs("div",{className:"vstack gap-3",children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted}`,children:"Width"}),e.jsx("input",{type:"number",className:"form-control-proper w-100",value:b.width,onChange:t=>G({width:parseInt(t.target.value)})})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted}`,children:b.type==="line"?"Thickness":"Height"}),e.jsx("input",{type:"number",className:"form-control-proper w-100",value:b.height,onChange:t=>G({height:parseInt(t.target.value)})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-xs fw-bold ${d.textMuted} text-uppercase mb-1`,children:"Color"}),e.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"36px",width:"100%",position:"relative"},children:e.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",border:"none"},value:b.color,onChange:t=>G({color:t.target.value})})})]})]})]}),e.jsxs("div",{className:`p-4 border-top ${d.border} mt-auto ${d.bgPanel}`,children:[e.jsxs("button",{className:`btn btn-outline-secondary w-100 mb-2 rounded-2 ${s?"text-white border-slate-600":""}`,onClick:De,children:[e.jsx("i",{className:"far fa-clone me-2"})," ","Duplicate"]}),e.jsxs("button",{className:"btn btn-outline-danger w-100 rounded-2",onClick:()=>{A(M.filter(t=>!h.has(t.id))),Y(new Set)},children:[e.jsx("i",{className:"far fa-trash-alt me-2"})," ","Delete"]})]})]}):e.jsxs("div",{className:`d-flex flex-column align-items-center justify-content-center h-100 ${d.textMuted} p-4 text-center`,children:[e.jsx("i",{className:"fas fa-mouse-pointer fa-3x mb-3 opacity-25"}),e.jsx("div",{className:"text-sm",children:"Select an element to resize or edit"})]})})]}),e.jsx(Xe,{show:!!ae,message:ae?.message,type:ae?.type==="error"?"danger":ae?.type,onClose:()=>O(null)}),e.jsx(We,{show:f,onClose:()=>W(!1),files:l,onSelect:t=>{Array.isArray(t)?pe(t.map(a=>({type:"image",src:a.url,name:a.name,path:a.path}))):pe([{type:"image",src:t.url,name:t.name,path:t.path}]),W(!1)},uploadUrl:route("events.certificates.upload-media",n.id),onUploadSuccess:()=>V(),onDelete:Ie,onRename:Be})]})}export{Ve as default};
