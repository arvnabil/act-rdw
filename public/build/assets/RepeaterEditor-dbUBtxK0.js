import{j as e,d as a,R as t,g as r,h as s,D as l,i as n,k as i,v as o,m as d,K as c,P as m,l as x,n as g,C as u}from"./vendor-BBKuPPxj.js";function h({schema:a,data:t,onChange:r}){const s=(e,a)=>{r({...t,[e]:a})};return a&&0!==a.length?e.jsx("div",{className:"space-y-1",children:a.map(a=>((a,t,r,s="")=>{var l;const n=a.name,i=void 0!==(null==t?void 0:t[n])?t[n]:"repeater"===a.type?[]:"",o=s+n;switch(a.type){case"text":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a.label}),e.jsx("input",{type:"text",value:i,onChange:e=>r(n,e.target.value),className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 text-gray-800"})]},o);case"textarea":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a.label}),e.jsx("textarea",{value:i,onChange:e=>r(n,e.target.value),rows:3,className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 resize-y text-gray-800"})]},o);case"image":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a.label}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 overflow-hidden flex-shrink-0 relative group",children:i?e.jsx("img",{src:i,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx("i",{className:"fa-regular fa-image"})})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",value:i,onChange:e=>r(n,e.target.value),placeholder:"Image URL...",className:"w-full text-xs border-gray-300 rounded shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var a;const t=e.target.files[0];if(!t)return;const s=new FormData;s.append("file",t);const l=e.target.nextElementSibling;l&&(l.innerText="Uploading..."),fetch("/admin/upload-media",{method:"POST",body:s,headers:{"X-CSRF-TOKEN":null==(a=document.querySelector('meta[name="csrf-token"]'))?void 0:a.getAttribute("content")}}).then(e=>e.json()).then(e=>{e.url&&r(n,e.url)}).catch(e=>console.error("Upload failed",e)).finally(()=>{l&&(l.innerText="Choose File"),e.target.value=null})},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsxs("button",{className:"w-full bg-white border border-gray-300 hover:bg-gray-50 text-gray-600 text-xs py-1.5 px-3 rounded shadow-sm flex items-center justify-center gap-2 transition",children:[e.jsx("i",{className:"fa-solid fa-cloud-arrow-up"}),e.jsx("span",{children:"Choose File"})]})]})]})]})]},o);case"select":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a.label}),e.jsx("select",{value:i,onChange:e=>r(n,e.target.value),className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 text-gray-800",children:null==(l=a.options)?void 0:l.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]},o);case"repeater":return e.jsx(y,{label:a.label,items:i,schema:a.schema,onChange:e=>r(n,e)},o);default:return null}})(a,t,s))}):e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-100 rounded-lg text-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-400",children:e.jsx("i",{className:"fa-regular fa-lock"})}),e.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Read Only Section"}),e.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"This section uses legacy content and is not editable."})]})}const b=Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"}));function f({id:a,index:t,data:r,schema:s,onRemove:l,onChange:n,expandedId:i,onToggleExpand:o}){const{attributes:d,listeners:c,setNodeRef:m,transform:x,transition:b,isDragging:f}=g({id:a}),y={transform:u.Transform.toString(x),transition:b,opacity:f?.5:1,position:"relative",zIndex:f?999:"auto"},p=i===a;return e.jsxs("div",{ref:m,style:y,className:"bg-white border border-gray-200 rounded-lg mb-2 shadow-sm group",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border-b border-gray-100 rounded-t-lg select-none",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{...d,...c,className:"cursor-grab active:cursor-grabbing text-gray-400 p-1 hover:text-gray-600",children:e.jsx("i",{className:"fa-solid fa-grip-lines"})}),e.jsxs("button",{type:"button",onClick:()=>o(a),className:"text-xs font-semibold text-gray-700 truncate flex-1 text-left",children:[p?e.jsx("i",{className:"fa-solid fa-chevron-down mr-2 text-[10px] text-gray-400"}):e.jsx("i",{className:"fa-solid fa-chevron-right mr-2 text-[10px] text-gray-400"}),"object"!=typeof r?r:r.title||r.name||r.text||r.label||"Item #".concat(t+1)]})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{type:"button",onClick:()=>l(t),className:"w-6 h-6 rounded flex items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 transition",title:"Remove Item",children:e.jsx("i",{className:"fa-regular fa-trash text-xs"})})})]}),p&&e.jsx("div",{className:"p-3 bg-white rounded-b-lg",children:s?e.jsx(h,{schema:s,data:r,onChange:e=>n(t,e)}):e.jsx("input",{type:"text",value:r,onChange:e=>n(t,e.target.value),className:"w-full text-sm border-gray-300 rounded"})})]})}function y({label:g,items:u=[],schema:h,onChange:b}){const[y,p]=a.useState(()=>(u||[]).map(e=>({id:"item-".concat(Math.random().toString(36).substr(2,9)),data:e})));t.useEffect(()=>{p(e=>e.length===u.length?e.map((e,a)=>({...e,data:u[a]})):(u||[]).map(e=>({id:"item-".concat(Math.random().toString(36).substr(2,9)),data:e})))},[u]);const[j,v]=a.useState(null),N=r(s(m),s(c,{coordinateGetter:d})),w=e=>{if(!confirm("Remove this item?"))return;const a=[...u];a.splice(e,1),b(a)},C=(e,a)=>{const t=[...u];t[e]=a,b(t)};return e.jsxs("div",{className:"mb-6 border border-gray-200 rounded-lg overflow-hidden flex flex-col bg-gray-50/50",children:[e.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b border-gray-200 flex justify-between items-center group",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-600 tracking-wider",children:g}),e.jsxs("button",{type:"button",onClick:()=>{const e={};h&&h.forEach(a=>{e[a.name]="repeater"===a.type?[]:""});const a=[...u,e];b(a)},className:"text-xs bg-white hover:bg-act-primary hover:text-white border border-gray-300 hover:border-act-primary text-gray-700 px-2 py-1 rounded shadow-sm transition flex items-center",children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"})," Add"]})]}),e.jsx("div",{className:"p-2",children:e.jsx(l,{sensors:N,collisionDetection:n,onDragEnd:e=>{const{active:a,over:t}=e;t&&a.id!==t.id&&p(e=>{const r=e.findIndex(e=>e.id===a.id),s=e.findIndex(e=>e.id===t.id),l=x(e,r,s),n=l.map(e=>e.data);return b(n),l})},children:e.jsx(i,{items:y.map(e=>e.id),strategy:o,children:0===y.length?e.jsx("div",{className:"text-center py-6 text-gray-400 text-xs italic",children:"No items yet."}):y.map((a,t)=>e.jsx(f,{id:a.id,index:t,data:a.data,schema:h,onRemove:w,onChange:C,expandedId:j,onToggleExpand:e=>v(e===j?null:e)},a.id))})})})]})}const p=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"}));export{p as R,h as S,b as a};
