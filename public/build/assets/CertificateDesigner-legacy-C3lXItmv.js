System.register(["./vendor-legacy-B38wspAF.js","./Toast-legacy-Bc5S6dWu.js"],function(e,t){"use strict";var s,n,a,r,o,l,i;return{setters:[e=>{s=e.d,n=e.j,a=e.S,r=e.a,o=e.H,l=e.e},e=>{i=e.T}],execute:function(){function t({element:e,isSelected:t,previewData:a,onMouseDown:r,onDrag:o,onResize:l,onDragStop:i,onDelete:d}){const c=s.useRef(null),x=s.useRef(!1),m=s.useRef(!1),p=s.useRef({x:0,y:0}),h=s.useRef(null);s.useEffect(()=>()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",b)},[]);const u=t=>{t.preventDefault();const s=t.clientX,n=t.clientY,a=s-p.current.x,r=n-p.current.y;m.current?(l(e.id,a,r,h.current),p.current={x:s,y:n}):x.current&&(o(a,r),p.current={x:s,y:n})},b=()=>{(x.current||m.current)&&i&&i(e.id),x.current=!1,m.current=!1,h.current=null,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",b)},f={position:"absolute",left:`${e.x}%`,top:`${e.y}%`,cursor:x.current?"grabbing":"grab",border:t?"1px solid #06b6d4":"1px solid transparent",boxShadow:t?"0 0 0 1px rgba(6, 182, 212, 1)":"none",userSelect:"none",transform:"translate(0, 0)",zIndex:t?50:10,transition:x.current||m.current?"none":"border 0.2s, box-shadow 0.2s"};return n.jsxs("div",{ref:c,onMouseDown:t=>{t.stopPropagation(),t.target.dataset.handle||(r(t,e.id),x.current=!0,m.current=!1,p.current={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",u),document.addEventListener("mouseup",b))},onClick:e=>e.stopPropagation(),style:f,className:"group draggable-item",children:[t&&n.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),d(e.id)},className:"position-absolute rounded-circle bg-danger text-white shadow-sm border",style:{width:"15px",height:"15px",top:"-18px",right:"-16px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",cursor:"pointer",zIndex:60,padding:"0",margin:"0"},title:"Delete",children:n.jsx("i",{className:"fas fa-times"})}),(()=>{const s={width:"100%",height:"100%"};if("qrcode"===e.type)return n.jsx("div",{style:{...s,width:e.width,height:e.width,background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"9px",color:"#000",textAlign:"center",padding:"5px",borderRadius:"8px"},children:n.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 p-1 bg-white border",children:[n.jsx("i",{className:"fas fa-qrcode fa-3x mb-1"}),n.jsx("div",{style:{fontSize:"0.6em",textTransform:"uppercase",fontWeight:"bold"},children:"SCAN ME"})]})});if("shape"===e.type)return n.jsx("div",{style:{...s,width:e.width,height:e.height,backgroundColor:e.color||"#000000",borderRadius:"circle"===e.shapeType?"50%":"4px"}});if("line"===e.type)return n.jsx("div",{style:{width:e.width,height:e.height,backgroundColor:e.color||"#000000"}});if("image"===e.type||"signature"===e.type)return n.jsx("div",{style:{width:e.width},children:n.jsx("img",{src:e.src,style:{width:"100%",pointerEvents:"none"}})});let r=e.text;!a||t||"text"!==e.type&&"variable"!==e.type||Object.keys(a).forEach(e=>{const t=new RegExp(`{{\\s*${e}\\s*}}`,"gi");r=r.replace(t,a[e])});const o=e.width&&e.width>0;return n.jsx("div",{style:{fontSize:`${e.fontSize||14}px`,color:e.color||"#000000",fontWeight:e.fontWeight||"normal",fontFamily:e.fontFamily||"Arial",fontStyle:e.fontStyle||"normal",textDecoration:e.textDecoration||"none",textAlign:e.textAlign||"left",width:o?`${e.width}px`:"auto",whiteSpace:o?"normal":"nowrap",wordWrap:o?"break-word":"normal",padding:"4px 8px",lineHeight:1.2,border:t&&o?"1px dashed #cbd5e1":"none"},children:r})})(),(()=>{if(!t)return null;if(!["shape","image","signature","qrcode","text","variable"].includes(e.type))return null;const s={width:"10px",height:"10px",background:"#fff",border:"1px solid #7c3aed",borderRadius:"50%",position:"absolute",zIndex:51};return n.jsx(n.Fragment,{children:[{id:"se",cursor:"nwse-resize",style:{bottom:"-5px",right:"-5px"}},{id:"sw",cursor:"nesw-resize",style:{bottom:"-5px",left:"-5px"}},{id:"ne",cursor:"nesw-resize",style:{top:"-5px",right:"-5px"}},{id:"nw",cursor:"nwse-resize",style:{top:"-5px",left:"-5px"}},{id:"e",cursor:"ew-resize",style:{top:"50%",right:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",backgroundColor:"#7c3aed",background:"#fff",border:"1px solid #7c3aed"}},{id:"w",cursor:"ew-resize",style:{top:"50%",left:"-4px",transform:"translateY(-50%)",height:"16px",width:"6px",borderRadius:"4px",background:"#fff",border:"1px solid #7c3aed"}}].map(e=>n.jsx("div",{"data-handle":e.id,onMouseDown:t=>((e,t)=>{e.stopPropagation(),e.preventDefault(),m.current=!0,x.current=!1,h.current=t,p.current={x:e.clientX,y:e.clientY},document.addEventListener("mousemove",u),document.addEventListener("mouseup",b)})(t,e.id),style:{...s,...e.style,cursor:e.cursor}},e.id))})})()]})}e("default",function({certificate:e,event:a}){const r=e.content_layout||{},x=Array.isArray(r),[m,p]=s.useState(x?r:r.elements||[]),[h,u]=s.useState(!x&&r.canvas?r.canvas:{width:1056,height:816}),[b,f]=s.useState(!x&&r.background?r.background:{x:0,y:0,scale:1}),[g,y]=s.useState(e.certificate_background),[w,v]=s.useState(!1),j=s.useRef(m);j.current=m;const[N,k]=s.useState(new Set),[C,S]=s.useState(!1),[$,z]=s.useState(1),[M,D]=s.useState(!1),[E,T]=s.useState({x:null,y:null}),[B,I]=s.useState(!0),[R,L]=s.useState(!0),[P,A]=s.useState([]),[F,O]=s.useState(!1),W=()=>{fetch(route("events.certificates.get-media",e.id)).then(e=>e.json()).then(e=>A(e)).catch(e=>console.error("Failed to load media",e))};s.useEffect(()=>{W()},[]);const Y=s.useRef(null),X=s.useRef(null),[G,_]=s.useState([e.content_layout||[]]),[U,q]=s.useState([]),H=()=>{if(G.length>1){const e=G[G.length-1],t=G[G.length-2];q(t=>[e,...t]),_(e=>e.slice(0,-1)),p(t)}},V=(e,t=!0)=>{p(e),t&&(e=>{_(t=>{const s=t[t.length-1];return JSON.stringify(s)===JSON.stringify(e)?t:[...t,e]}),q([])})(e)},J=s.useMemo(()=>0===N.size?null:[...N][N.size-1],[N]),K=m.find(e=>e.id===J),[Z,Q]=s.useState([]),[ee,te]=s.useState(null),[se,ne]=s.useState({enabled:!1,columns:12,margin:40,gutter:20,color:"#FF0000",opacity:.1}),[ae,re]=s.useState(!1),[oe,le]=s.useState(null);s.useEffect(()=>{document.createElement("link")},[]);const ie=s.useMemo(()=>({participant_name:"John Doe",event_title:a.title||"Event Title",date:(new Date).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}),certificate_code:"CERT-SAMPLE-123"}),[a.title]);s.useEffect(()=>{const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Alex+Brush&family=Bebas+Neue&family=Cinzel:wght@400;700&family=Cormorant+Garamond:wght@400;600&family=Great+Vibes&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;600&family=Open+Sans:wght@400;600&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap",e.rel="stylesheet",document.head.appendChild(e);const t=()=>T({x:null,y:null});window.addEventListener("mouseup",t);const s=e=>{te(t=>{if(!t)return null;if(!Y.current)return t;const s=Y.current.getBoundingClientRect();let n=0;return n="horizontal"===t.type?(e.clientY-s.top)/$:(e.clientX-s.left)/$,{...t,currentPos:n}})},n=e=>{te(e=>{if(!e)return null;const t=e.currentPos<-20;return Q(s=>{const n=[...s];return void 0!==e.index&&-1!==e.index?(t?n.splice(e.index,1):n[e.index]={...n[e.index],pos:e.currentPos},n):t?s:[...s,{type:"horizontal"===e.type?"y":"x",pos:e.currentPos}]}),null})};return window.addEventListener("mousemove",s),window.addEventListener("mouseup",n),()=>{document.head.removeChild(e),window.removeEventListener("mouseup",t),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",n)}},[$]);const de=(e,t,s=-1)=>{if(t.preventDefault(),t.stopPropagation(),!Y.current)return;const n=Y.current.getBoundingClientRect();let a=e;"y"===e&&(a="horizontal"),"x"===e&&(a="vertical");let r=0;r="horizontal"===a?(t.clientY-n.top)/$:(t.clientX-n.left)/$,te({type:a,currentPos:r,index:s})},ce=(e,t)=>{de(e,t,-1)},xe=e=>{const t=(Array.isArray(e)?e:[e]).map(e=>{const t=e.type,s={id:Date.now()+Math.random(),type:t,x:50+20*Math.random(),y:50+20*Math.random(),...e};return"text"===t||"variable"===t?(s.text=e.text||"New Text",s.fontSize=28,s.color="#1e293b",s.fontWeight="normal",s.fontFamily="'Montserrat', sans-serif",s.textAlign="center"):"qrcode"===t?s.width=100:"shape"===t?(s.width=150,s.height=100,s.color="#0f172a",s.shapeType=e.shapeType||"rectangle"):"line"===t?(s.width=300,s.height=3,s.color="#000000"):"signature"!==t&&"image"!==t||(s.width=200,s.src=e.src||""),s});V([...m,...t]),k(new Set(t.map(e=>e.id)))},me=(e,t={})=>{xe([{type:e,...t}])};s.useEffect(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"z"===e.key&&(e.preventDefault(),H())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[H]);const pe=e=>{const t=m.map(t=>N.has(t.id)?{...t,...e}:t);V(t)},he=e=>{const t=m.filter(t=>t.id!==e);V(t);const s=new Set(N);s.delete(e),k(s)},ue=(e,t)=>{if(!Y.current||!X.current)return;const s=Y.current.getBoundingClientRect(),n=100/s.width,a=100/s.height,r=e*n,o=t*a;p(e=>e.map(e=>N.has(e.id)?{...e,x:Math.max(0,Math.min(100,e.x+r)),y:Math.max(0,Math.min(100,e.y+o))}:e))},be=(e,t,s,n)=>{if(!Y.current)return;const a=Y.current.getBoundingClientRect(),r=100/a.width,o=100/a.height;p(a=>a.map(a=>{if(a.id!==e)return a;const l=t/$,i=s/$;let d=a.width||100,c=a.height||100,x=a.x,m=a.y;const p=t/$*r,h=s/$*o;return n.includes("e")&&(d+=l),n.includes("w")&&(d-=l,x+=p),n.includes("s")&&(c+=i),n.includes("n")&&(c-=i,m+=h),{...a,x:x,y:m,width:Math.max(10,d),height:Math.max(10,c)}}))},fe=R?{bgApp:"bg-[#0f172a]",bgPanel:"bg-[#1e293b]",bgInput:"bg-[#1e293b]",border:"border-slate-700",textMain:"text-[#e1e4e5]",textMuted:"text-slate-400",glassHdr:"glass-panel-dark",glassSide:"glass-panel-dark",highlight:"text-info",grid:"grid-bg-dark"}:{bgApp:"bg-slate-50",bgPanel:"bg-white",bgInput:"bg-white",border:"border-slate-200",textMain:"text-slate-700",textMuted:"text-slate-500",glassHdr:"glass-panel-light",glassSide:"glass-panel-light",highlight:"text-success",grid:"grid-bg-light"};return n.jsxs("div",{className:`d-flex flex-column vh-100 ${fe.bgApp} ${fe.textMain} transition-colors duration-300`,style:{fontFamily:"'Inter', sans-serif"},children:[n.jsx(o,{title:`Designer - ${a.title}`}),n.jsx("style",{children:`\n                /* Transition for smooth theme switch */\n                .transition-colors { transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease; }\n\n                ::-webkit-scrollbar { width: 6px; height: 6px; }\n                ::-webkit-scrollbar-track { background: transparent; }\n                ::-webkit-scrollbar-thumb { background: ${R?"#334155":"#cbd5e1"}; border-radius: 3px; }\n\n                .glass-panel-dark {\n                    background: rgba(30, 41, 59, 0.95); /* More opaque for professional look */\n                    backdrop-filter: blur(12px);\n                    border: 1px solid rgba(255, 255, 255, 0.05);\n                }\n                .glass-panel-light {\n                    background: rgba(255, 255, 255, 0.95);\n                    backdrop-filter: blur(12px);\n                    border: 1px solid rgba(0, 0, 0, 0.05);\n                }\n\n                .grid-bg-dark {\n                    background-image: radial-gradient(rgba(51, 65, 85, 0.4) 1px, transparent 1px);\n                    background-size: 24px 24px;\n                }\n                .grid-bg-light {\n                    background-image: radial-gradient(rgba(148, 163, 184, 0.4) 1px, transparent 1px);\n                    background-size: 24px 24px;\n                }\n\n                .btn-tech {\n                    background: linear-gradient(135deg, ${R?"#06b6d4":"#3b82f6"} 0%, ${R?"#3b82f6":"#2563eb"} 100%);\n                    color: white; border: none;\n                    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);\n                    transition: all 0.2s;\n                }\n                .btn-tech:hover { transform: translateY(-1px); box-shadow: 0 8px 10px -2px rgba(59, 130, 246, 0.4); }\n\n                /* Sidebar Buttons */\n                .sidebar-btn {\n                    transition: all 0.2s;\n                    border: 1px solid #dee2e6;\n                    color: ${R?"#e1e4e5":"#334155"};\n                    background: ${R?"rgba(255, 255, 255, 0.05)":"transparent"};\n                }\n                .sidebar-btn:hover {\n                    background: ${R?"rgba(255, 255, 255, 0.1)":"#f1f5f9"}; /* Theme color hover */\n                    border-color: ${fe.border};\n                    transform: translateX(2px);\n                }\n\n                /* Upload Button */\n                .btn-upload {\n                    background: white; color: #333; border: 1px solid #ddd; transition: all 0.3s;\n                }\n                .btn-upload:hover {\n                    background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);\n                    color: white; border-color: transparent;\n                }\n\n                /* Inputs - "Proper" Style */\n                .form-control-proper {\n                    border-radius: 4px; /* Less rounded */\n                    border: 1px solid ${R?"#475569":"#cbd5e1"};\n                    background-color: ${R?"#0f172a":"#fff"}; /* Input distinct bg */\n                    color: ${R?"#fff":"#333"};\n                    padding: 0.375rem 0.75rem;\n                    margin-bottom: 1rem;\n                    font-size: 0.875rem;\n                }\n                .form-control-proper:focus {\n                    border-color: #06b6d4;\n                    color: ${R?"#333":"#000"};\n                    box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);\n                    outline: none;\n                }\n                .form-control-proper:hover {\n                    color: ${R?"#333":"#000"};\n                }\n\n                .form-select-proper {\n                    margin-bottom: 1rem;\n                    border-radius: 4px;\n                    border: 1px solid ${R?"#475569":"#cbd5e1"};\n                    background-color: ${R?"#0f172a":"#fff"};\n                    color: ${R?"#fff":"#333"};\n                    padding: 0.375rem 2rem 0.375rem 0.75rem;\n                    font-size: 0.875rem;\n                }\n            `}),n.jsxs("header",{className:`px-4 py-3 d-flex justify-content-between align-items-center shadow-sm position-relative ${fe.glassHdr} border-bottom ${fe.border}`,style:{zIndex:100},children:[n.jsxs("div",{className:"d-flex align-items-center gap-3",children:[n.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center "+(R?"bg-slate-800 text-white":"bg-slate-100 text-dark"),onClick:()=>window.close(),style:{width:36,height:36},children:n.jsx("i",{className:"fas fa-chevron-left"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"fw-bold ls-1 "+(R?"text-white":"text-dark"),style:{fontSize:"1.1rem"},children:["CERTIFICATE"," ",n.jsx("span",{className:fe.highlight,children:"STUDIO"})]}),n.jsx("div",{className:`text-xs ${R?"text-white":"text-dark"} fw-medium`,children:a.title})]})]}),n.jsxs("div",{className:"d-flex align-items-center gap-3",children:[n.jsx("button",{className:"btn btn-sm rounded-circle d-flex align-items-center justify-content-center border-0 "+(R?"bg-slate-800 text-warning":"bg-slate-200 text-slate-600"),onClick:()=>L(!R),style:{width:32,height:32},children:n.jsx("i",{className:"fas "+(R?"fa-sun":"fa-moon")})}),n.jsxs("div",{className:`d-flex align-items-center rounded-pill p-1 border ${fe.border} ${fe.bgInput}`,children:[n.jsx("button",{className:`btn btn-sm ${R?"text-white":"text-slate-600"} hover-text-primary`,onClick:()=>z(e=>Math.max(.4,e-.1)),children:n.jsx("i",{className:"fas fa-minus"})}),n.jsxs("span",{className:"small px-2 fw-medium "+(R?"text-white":"text-slate-800"),style:{minWidth:40,textAlign:"center"},children:[Math.round(100*$),"%"]}),n.jsx("button",{className:`btn btn-sm ${R?"text-white":"text-slate-600"} hover-text-primary`,onClick:()=>z(e=>Math.min(2.5,e+.1)),children:n.jsx("i",{className:"fas fa-plus"})})]}),n.jsx("div",{className:`h-50 border-end ${fe.border} mx-1`}),n.jsxs("div",{className:`d-flex align-items-center rounded-pill px-2 border ${fe.border} me-2 ${fe.bgInput}`,children:[n.jsx("button",{className:"btn btn-sm "+(R?"text-white":"text-slate-600"),onClick:()=>{Q([{type:"x",pos:421},{type:"y",pos:297.5}])},title:"Add Center Guides (2x2)",children:n.jsx("i",{className:"fas fa-border-all"})}),n.jsx("button",{className:"btn btn-sm "+(R?"text-white":"text-slate-600"),onClick:()=>{Q([{type:"x",pos:842/3},{type:"x",pos:842/3*2},{type:"y",pos:595/3},{type:"y",pos:595/3*2}])},title:"Add Thirds Guides (3x3)",children:n.jsx("i",{className:"fas fa-th"})}),n.jsx("button",{className:"btn btn-sm text-danger",onClick:()=>Q([]),title:"Clear All Guides",children:n.jsx("i",{className:"fas fa-trash-alt"})})]}),n.jsxs("div",{className:"position-relative me-2",children:[n.jsxs("button",{className:"btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 "+(se.enabled?"bg-primary text-white border-primary":R?"text-white border-slate-600 bg-slate-800":"text-slate-600 border-slate-300 bg-white"),onClick:()=>re(!ae),title:"Configure Layout Columns",children:[n.jsx("i",{className:"fas fa-columns"}),n.jsx("span",{className:"d-none d-md-inline small",children:"Columns"})]}),ae&&n.jsxs("div",{className:"position-absolute top-100 end-0 mt-2 p-3 rounded shadow-lg",onClick:e=>e.stopPropagation(),style:{width:"280px",zIndex:2e3,backgroundColor:R?"#1e293b":"#ffffff",borderColor:R?"#334155":"#e2e8f0",borderWidth:"1px",borderStyle:"solid"},children:[n.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[n.jsx("span",{className:"fw-bold text-sm "+(R?"text-white":"text-slate-800"),children:"Layout Grid"}),n.jsxs("div",{className:"form-check form-switch m-0 d-flex align-items-center",children:[n.jsx("input",{className:"form-check-input mt-0",type:"checkbox",checked:se.enabled,onChange:e=>ne(t=>({...t,enabled:e.target.checked})),id:"gridToggle",style:{cursor:"pointer",width:"2.5rem",height:"1.25rem",border:"2px solid rgba(255,255,255,0.2)",backgroundColor:se.enabled?"#ef4444":"#64748b",backgroundImage:"none"}}),n.jsx("label",{className:"form-check-label ms-2 cursor-pointer small text-muted",htmlFor:"gridToggle",children:se.enabled?"On":"Off"})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"text-xs fw-semibold d-block mb-1 "+(R?"text-slate-400":"text-slate-500"),children:"Columns (Count)"}),n.jsx("input",{type:"number",className:"form-control form-control-sm",value:se.columns,onChange:e=>{const t=parseInt(e.target.value);ne(e=>({...e,enabled:!0,columns:isNaN(t)?"":Math.max(1,Math.min(24,t))}))},min:"1",max:"24",style:{height:"32px",fontSize:"14px"}})]}),n.jsxs("div",{className:"row g-2 mb-3",children:[n.jsxs("div",{className:"col-6",children:[n.jsx("label",{className:"text-xs fw-semibold d-block mb-1 "+(R?"text-slate-400":"text-slate-500"),children:"Margin (px)"}),n.jsx("input",{type:"number",className:"form-control form-control-sm",value:se.margin,onChange:e=>{const t=parseInt(e.target.value);ne(e=>({...e,enabled:!0,margin:isNaN(t)?"":Math.max(0,t)}))},style:{height:"32px",fontSize:"14px"}})]}),n.jsxs("div",{className:"col-6",children:[n.jsx("label",{className:"text-xs fw-semibold d-block mb-1 "+(R?"text-slate-400":"text-slate-500"),children:"Gutter (px)"}),n.jsx("input",{type:"number",className:"form-control form-control-sm",value:se.gutter,onChange:e=>{const t=parseInt(e.target.value);ne(e=>({...e,enabled:!0,gutter:isNaN(t)?"":Math.max(0,t)}))},style:{height:"32px",fontSize:"14px"}})]})]}),n.jsxs("div",{className:"mb-1",children:[n.jsxs("div",{className:"d-flex justify-content-between font-sm mb-1",children:[n.jsx("label",{className:"text-xs fw-semibold "+(R?"text-slate-400":"text-slate-500"),children:"Opacity"}),n.jsxs("span",{className:"text-xs "+(R?"text-slate-400":"text-slate-500"),children:[Math.round(100*se.opacity),"%"]})]}),n.jsx("input",{type:"range",className:"form-range w-100",min:"0.05",max:"0.5",step:"0.05",value:se.opacity,onChange:e=>ne(t=>({...t,enabled:!0,opacity:parseFloat(e.target.value)})),style:{accentColor:"#ef4444"}})]})]})]}),n.jsx("div",{className:"h-100 mx-3 border-end border-secondary opacity-25"}),n.jsxs("div",{className:"d-flex align-items-center gap-2 me-2",children:[n.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center "+(R?"bg-slate-800 text-white":"bg-slate-200 text-dark"),onClick:H,disabled:G.length<=1,style:{width:32,height:32},title:"Undo (Ctrl+Z)",children:n.jsx("i",{className:"fas fa-undo"})}),n.jsx("button",{className:"btn btn-sm rounded-circle border-0 d-flex align-items-center justify-content-center "+(R?"bg-slate-800 text-white":"bg-slate-200 text-dark"),onClick:()=>{if(U.length>0){const e=U[0];_(t=>[...t,e]),q(e=>e.slice(1)),p(e)}},disabled:0===U.length,style:{width:32,height:32},title:"Redo (Ctrl+Y)",children:n.jsx("i",{className:"fas fa-redo"})})]}),n.jsx("button",{className:"btn btn-sm border rounded-pill px-3 d-flex align-items-center gap-2 "+(B?"bg-slate-100 text-slate-700":"bg-slate-800 text-white"),onClick:()=>I(!B),title:B?"Collapse Sidebar":"Expand Sidebar",children:n.jsx("i",{className:"fas fa-"+(B?"chevron-right":"chevron-left"),style:{color:R?"#fff":"#000"}})}),n.jsxs("button",{className:"btn btn-tech rounded-pill px-4 fw-medium d-flex align-items-center gap-2",onClick:()=>{S(!0),l.post(route("events.certificates.update-design",e.id),{content_layout:{elements:m,canvas:h,background:b},image_files:P,certificate_background:g},{onFinish:()=>S(!1),preserveScroll:!0,onSuccess:()=>{le({message:"Design saved successfully!",type:"success"})},onError:e=>{console.error("Save failed:",e);const t=Object.values(e)[0];le({message:`Failed: ${t||"Check console"}`,type:"error"})}})},disabled:C,children:[C?n.jsx("i",{className:"fas fa-circle-notch fa-spin"}):n.jsx("i",{className:"fas fa-save"}),n.jsx("span",{children:"Save"})]})]})]}),n.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[n.jsxs("aside",{className:`d-flex flex-column ${fe.glassSide} border-end ${fe.border} overflow-auto`,style:{width:"280px"},children:[n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:`text-xs fw-bold ${fe.highlight} text-uppercase ls-1 mb-3`,children:[n.jsx("i",{className:"fas fa-layer-group me-1"})," Elements"]}),n.jsxs("div",{className:"d-grid gap-2",children:[n.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>me("text"),children:[n.jsx("i",{className:"fas fa-heading fa-fw opacity-50"})," ",n.jsx("span",{children:"Headline / Text"})]}),n.jsxs("button",{className:"sidebar-btn text-start py-2 px-3 rounded-2 d-flex align-items-center gap-3",onClick:()=>me("line"),children:[n.jsx("i",{className:"fas fa-minus fa-fw opacity-50"})," ",n.jsx("span",{children:"Line Separator"})]}),n.jsxs("div",{className:"d-flex gap-2",children:[n.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("shape",{shapeType:"rectangle"}),children:n.jsx("i",{className:"far fa-square fa-lg"})}),n.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("shape",{shapeType:"circle"}),children:n.jsx("i",{className:"far fa-circle fa-lg"})}),n.jsx("button",{className:"sidebar-btn flex-grow-1 py-3 rounded-2",onClick:()=>me("qrcode"),children:n.jsx("i",{className:"fas fa-qrcode fa-lg"})})]})]})]}),n.jsxs("div",{className:`p-4 border-top ${fe.border}`,children:[n.jsxs("div",{className:`text-xs fw-bold ${fe.highlight} text-uppercase ls-1 mb-3`,children:[n.jsx("i",{className:"fas fa-file-alt me-1"})," Page Setup"]}),n.jsxs("div",{className:"d-flex gap-2 mb-3",children:[n.jsx("button",{className:"btn btn-sm w-50 "+(h.width>h.height?"btn-tech":R?"btn-outline-secondary":"btn-outline-dark"),onClick:()=>u({width:1056,height:816}),children:n.jsxs("div",{className:"d-flex flex-column align-items-center",children:[n.jsxs("span",{children:[n.jsx("i",{className:"far fa-file-image me-1"})," ","Landscape"]}),n.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"1056 x 816 px"})]})}),n.jsx("button",{className:"btn btn-sm w-50 "+(h.width<h.height?"btn-tech":R?"btn-outline-secondary":"btn-outline-dark"),onClick:()=>u({width:816,height:1056}),children:n.jsxs("div",{className:"d-flex flex-column align-items-center",children:[n.jsxs("span",{children:[n.jsx("i",{className:"far fa-file me-1"})," ","Portrait"]}),n.jsx("span",{className:"mt-1",style:{fontSize:"0.65rem",opacity:.8},children:"816 x 1056 px"})]})})]}),n.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[n.jsx("span",{className:"text-xs",children:"Background Edit"}),n.jsx("div",{className:"form-check form-switch",children:n.jsx("input",{className:"form-check-input",type:"checkbox",checked:w,onChange:()=>v(!w)})})]}),w&&n.jsxs("div",{className:"mb-2",children:[n.jsxs("label",{className:"text-xs text-muted mb-1",children:["Scale: ",Math.round(100*b.scale),"%"]}),n.jsx("input",{type:"range",className:"form-range",min:"0.5",max:"3",step:"0.1",value:b.scale,onChange:e=>f(t=>({...t,scale:parseFloat(e.target.value)}))})]})]}),n.jsxs("div",{className:`p-4 border-top ${fe.border}`,children:[n.jsxs("div",{className:`text-xs fw-bold ${fe.highlight} text-uppercase ls-1 mb-3`,children:[n.jsx("i",{className:"fas fa-code-branch me-1"})," ","Variables"]}),n.jsx("div",{className:"d-grid gap-2",children:["Participant Name","Event Title","Date","Certificate Code"].map((e,t)=>n.jsxs("button",{className:"sidebar-btn w-100 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>me("text",{text:`{{ ${e.toLowerCase().replace(" ","_")} }}`}),children:[n.jsx("div",{className:`d-flex align-items-center justify-content-center ${R?"bg-slate-700 text-slate-300":"bg-slate-200 text-dark"} me-3 rounded-1`,style:{minWidth:"40px",height:"22px",fontSize:"10px",fontWeight:"bold"},children:"VAR"}),n.jsx("span",{className:"fw-medium",children:e})]},e))})]}),n.jsx("div",{className:`p-4 border-top ${fe.border} flex-grow-1`,children:n.jsxs("div",{className:"mb-4",children:[n.jsx("div",{className:"d-flex justify-content-between align-items-center mb-3",children:n.jsxs("div",{className:`text-xs fw-bold ${fe.highlight} text-uppercase ls-1`,children:[n.jsx("i",{className:"fas fa-photo-film me-1"})," ","Media Files"]})}),n.jsxs("button",{className:"sidebar-btn w-100 mb-2 text-start py-2 px-3 rounded-2 small d-flex align-items-center",onClick:()=>O(!0),children:[n.jsx("i",{className:"fas fa-images fa-lg me-2"}),n.jsx("span",{className:"fw-medium",children:"Manage Media Library"})]}),n.jsxs("div",{className:`text-xs text-center ${fe.textMuted} mb-3`,children:[P.length," files available"]})]})})]}),n.jsxs("div",{className:"flex-grow-1 d-flex flex-column overflow-hidden position-relative",children:[n.jsxs("div",{className:"d-flex",style:{height:"24px",flexShrink:0,zIndex:50,background:R?"#1e293b":"#f1f5f9"},children:[n.jsx("div",{style:{width:"24px",flexShrink:0,borderRight:"1px solid "+(R?"#334155":"#cbd5e1"),borderBottom:"1px solid "+(R?"#334155":"#cbd5e1")}}),n.jsx("div",{className:"flex-grow-1 position-relative overflow-hidden",children:n.jsx(d,{type:"horizontal",zoom:$,offset:E.rulerX||0,theme:{bg:R?"#1e293b":"#f1f5f9",borderColor:R?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:R?"#94a3b8":"#64748b"},onDragStart:ce})})]}),n.jsxs("div",{className:"d-flex flex-grow-1 overflow-hidden position-relative",children:[n.jsx("div",{style:{width:"24px",flexShrink:0,zIndex:50,overflow:"hidden",background:R?"#1e293b":"#f1f5f9"},children:n.jsx(d,{type:"vertical",zoom:$,offset:E.rulerY||0,theme:{bg:R?"#1e293b":"#f1f5f9",borderColor:R?"#334155":"#cbd5e1",tickColor:"#94a3b8",textColor:R?"#94a3b8":"#64748b"},onDragStart:ce})}),n.jsxs("main",{className:`flex-grow-1 position-relative d-flex align-items-center justify-content-center overflow-hidden ${fe.grid}`,id:"canvas-scroll-container",onClick:()=>k(new Set),style:{overflow:"auto"},children:[null!==E.x&&n.jsx("div",{className:"position-absolute h-100",style:{left:`${E.x}%`,width:"1px",background:R?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),null!==E.y&&n.jsx("div",{className:"position-absolute w-100",style:{top:`${E.y}%`,height:"1px",background:R?"#06b6d4":"#3b82f6",boxShadow:"0 0 8px currentColor",zIndex:100}}),ee&&n.jsx("div",{className:"position-absolute",style:{zIndex:101,pointerEvents:"none",background:"#10b981",..."horizontal"===ee.type?{left:0,right:0,top:0,height:"1px",transform:`translateY(${E.rulerY+ee.currentPos*$}px)`}:{top:0,bottom:0,left:0,width:"1px",transform:`translateX(${E.rulerX+ee.currentPos*$}px)`}},children:n.jsx("span",{className:"position-absolute bg-success text-white px-1 text-xs",style:{top:2,left:2},children:Math.round(ee.currentPos)})}),n.jsx("div",{className:"overflow-auto w-100 h-100 d-flex align-items-center justify-content-center p-5",ref:X,onScroll:()=>{if(Y.current&&X.current){const e=Y.current.getBoundingClientRect(),t=X.current.getBoundingClientRect();T(s=>({...s,rulerX:e.left-t.left,rulerY:e.top-t.top}))}},children:n.jsxs("div",{ref:Y,className:"position-relative bg-white shadow-sm transition-all duration-300",style:{width:`${h.width}px`,height:`${h.height}px`,minWidth:`${h.width}px`,minHeight:`${h.height}px`,transform:`scale(${$})`,transformOrigin:"center center",boxShadow:R?"0 0 50px rgba(0,0,0,0.5)":"0 0 30px rgba(0,0,0,0.1)",overflow:"hidden"},onDoubleClick:e=>{(e.target===Y.current||e.target.classList?.contains("bg-layer"))&&(v(!w),le({message:w?"Background Locked":"Background Edit Mode: Drag to move",type:"info"}))},children:[n.jsx("div",{className:"bg-layer position-absolute w-100 h-100 start-0 top-0 "+(w?"cursor-move":""),style:{zIndex:0,backgroundImage:g?`url("/storage/${g}")`:"none",backgroundSize:"cover",backgroundPosition:"center",transform:`translate(${b.x}px, ${b.y}px) scale(${b.scale})`,transformOrigin:"center center",opacity:1,pointerEvents:w?"auto":"none"},onMouseDown:e=>{if(!w)return;e.preventDefault(),e.stopPropagation();const t=e.clientX,s=e.clientY,n=b.x,a=b.y,r=e=>{const r=(e.clientX-t)/$,o=(e.clientY-s)/$;f(e=>({...e,x:n+r,y:a+o}))},o=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",o)}}),w&&n.jsx("div",{className:"position-absolute top-0 start-0 m-2 badge bg-warning text-dark z-index-10",children:"Background Edit Mode"}),se.enabled&&n.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100",style:{zIndex:89,pointerEvents:"none",padding:`0 ${se.margin}px`,display:"flex",gap:(se.margin,"0px")},children:n.jsx("div",{className:"w-100 h-100 d-flex",style:{gap:`${se.gutter}px`,pointerEvents:"none"},children:[...Array(se.columns)].map((e,t)=>n.jsx("div",{className:"flex-grow-1 h-100",style:{backgroundColor:se.color,opacity:se.opacity,pointerEvents:"none"}},t))})}),Z.map((e,t)=>n.jsx("div",{className:"position-absolute guide-line",onMouseDown:s=>de(e.type,s,t),style:{zIndex:90,pointerEvents:"auto",cursor:"y"===e.type?"row-resize":"col-resize",..."y"===e.type?{left:0,right:0,top:e.pos-2+"px",height:"5px",borderTop:"2px solid transparent",borderBottom:"2px solid transparent",backgroundColor:"transparent"}:{top:0,bottom:0,left:e.pos-2+"px",width:"5px",borderLeft:"2px solid transparent",borderRight:"2px solid transparent",backgroundColor:"transparent"}},children:n.jsx("div",{style:{width:"y"===e.type?"100%":"1px",height:"y"===e.type?"1px":"100%",backgroundColor:"#06b6d4",position:"absolute",top:"y"===e.type?"2px":0,left:"y"===e.type?0:"2px",boxShadow:"0 0 2px rgba(255,255,255,0.5)"}})},t)),m.map(e=>n.jsx(t,{element:e,previewData:ie,isSelected:N.has(e.id),onMouseDown:t=>{if(t.shiftKey){const t=new Set(N);t.has(e.id)?t.delete(e.id):t.add(e.id),k(t)}else N.has(e.id)||k(new Set([e.id]))},onDrag:ue,onResize:be,onDragStop:()=>V(j.current),onDelete:he},e.id))]})})]})]})]}),n.jsx("aside",{className:`${fe.glassSide} border-start ${fe.border} d-flex flex-column shadow-lg z-20 transition-all duration-300 ease-in-out`,style:{width:B?"300px":"0px",overflow:"hidden",opacity:B?1:0},children:K&&N.size>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:`p-4 ${fe.bgPanel} border-bottom ${fe.border} text-center`,style:{minWidth:"300px"},children:n.jsx("div",{className:`text-xs fw-bold ${fe.highlight} text-uppercase ls-1`,children:"Properties"})}),n.jsxs("div",{className:"p-4 flex-grow-1 overflow-auto",style:{minWidth:"300px"},children:[("text"===K.type||"variable"===K.type)&&n.jsxs("div",{className:"vstack gap-5",children:[" ",n.jsxs("div",{children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted} text-uppercase mb-2`,children:"Content"}),n.jsx("textarea",{className:"form-control-proper w-100",rows:"3",value:K.text,onChange:e=>pe({text:e.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted} text-uppercase mb-2`,children:"Typography"}),n.jsxs("div",{className:"vstack gap-3",children:[n.jsx("select",{className:"form-select-proper w-100",value:K.fontFamily,onChange:e=>pe({fontFamily:e.target.value}),children:[{label:"Cinzel",value:"'Cinzel', serif"},{label:"Montserrat",value:"'Montserrat', sans-serif"},{label:"Playfair Display",value:"'Playfair Display', serif"},{label:"Great Vibes",value:"'Great Vibes', cursive"},{label:"Lato",value:"'Lato', sans-serif"},{label:"Pinyon Script",value:"'Pinyon Script', cursive"},{label:"Cormorant Garamond",value:"'Cormorant Garamond', serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Bebas Neue",value:"'Bebas Neue', display"},{label:"Alex Brush",value:"'Alex Brush', cursive"}].map(e=>n.jsx("option",{value:e.value,children:e.label},e.value))}),n.jsxs("div",{className:"row g-2 align-items-center",children:[n.jsx("div",{className:"col-8",children:n.jsx("div",{className:"input-group input-group-sm",children:n.jsx("input",{type:"number",className:"form-control-proper w-100",value:K.fontSize,onChange:e=>pe({fontSize:parseInt(e.target.value)}),placeholder:"Size"})})}),n.jsx("div",{className:"col-4",children:n.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"31px",width:"100%",position:"relative",backgroundColor:K.color},children:n.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",opacity:0},value:K.color,onChange:e=>pe({color:e.target.value})})})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted} text-uppercase mb-2`,children:"Style"}),n.jsxs("div",{className:"btn-group w-100 mb-3",children:[n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"bold"===K.fontWeight?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({fontWeight:"bold"===K.fontWeight?"normal":"bold"}),children:n.jsx("i",{className:"fas fa-bold"})}),n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"italic"===K.fontStyle?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({fontStyle:"italic"===K.fontStyle?"normal":"italic"}),children:n.jsx("i",{className:"fas fa-italic"})}),n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"underline"===K.textDecoration?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({textDecoration:"underline"===K.textDecoration?"none":"underline"}),children:n.jsx("i",{className:"fas fa-underline"})})]}),n.jsxs("div",{className:"btn-group w-100",children:[n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"left"===K.textAlign?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({textAlign:"left"}),children:n.jsx("i",{className:"fas fa-align-left"})}),n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"center"===K.textAlign?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({textAlign:"center"}),children:n.jsx("i",{className:"fas fa-align-center"})}),n.jsx("button",{className:`btn btn-sm btn-outline-secondary ${R?"text-white":""} ${"right"===K.textAlign?R?"btn-tech border-0":"bg-info border-info text-white":""}`,onClick:()=>pe({textAlign:"right"}),children:n.jsx("i",{className:"fas fa-align-right"})})]})]})]}),("line"===K.type||"shape"===K.type)&&n.jsxs("div",{className:"vstack gap-3",children:[n.jsxs("div",{className:"row g-2",children:[n.jsxs("div",{className:"col-6",children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted}`,children:"Width"}),n.jsx("input",{type:"number",className:"form-control-proper w-100",value:K.width,onChange:e=>pe({width:parseInt(e.target.value)})})]}),n.jsxs("div",{className:"col-6",children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted}`,children:"line"===K.type?"Thickness":"Height"}),n.jsx("input",{type:"number",className:"form-control-proper w-100",value:K.height,onChange:e=>pe({height:parseInt(e.target.value)})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:`text-xs fw-bold ${fe.textMuted} text-uppercase mb-1`,children:"Color"}),n.jsx("div",{className:"rounded overflow-hidden border border-secondary",style:{height:"36px",width:"100%",position:"relative"},children:n.jsx("input",{type:"color",className:"position-absolute",style:{top:"-10px",left:"-10px",width:"200%",height:"200%",cursor:"pointer",border:"none"},value:K.color,onChange:e=>pe({color:e.target.value})})})]})]})]}),n.jsxs("div",{className:`p-4 border-top ${fe.border} mt-auto ${fe.bgPanel}`,children:[n.jsxs("button",{className:"btn btn-outline-secondary w-100 mb-2 rounded-2 "+(R?"text-white border-slate-600":""),onClick:()=>{const e=m.filter(e=>N.has(e.id)).map(e=>({...e,id:Date.now()+Math.random(),x:e.x+2,y:e.y+2}));V([...m,...e]),k(new Set(e.map(e=>e.id)))},children:[n.jsx("i",{className:"far fa-clone me-2"})," ","Duplicate"]}),n.jsxs("button",{className:"btn btn-outline-danger w-100 rounded-2",onClick:()=>{p(m.filter(e=>!N.has(e.id))),k(new Set)},children:[n.jsx("i",{className:"far fa-trash-alt me-2"})," ","Delete"]})]})]}):n.jsxs("div",{className:`d-flex flex-column align-items-center justify-content-center h-100 ${fe.textMuted} p-4 text-center`,children:[n.jsx("i",{className:"fas fa-mouse-pointer fa-3x mb-3 opacity-25"}),n.jsx("div",{className:"text-sm",children:"Select an element to resize or edit"})]})})]}),n.jsx(i,{show:!!oe,message:oe?.message,type:"error"===oe?.type?"danger":oe?.type,onClose:()=>le(null)}),n.jsx(c,{show:F,onClose:()=>O(!1),files:P,onSelect:e=>{Array.isArray(e)?xe(e.map(e=>({type:"image",src:e.url,name:e.name,path:e.path}))):xe([{type:"image",src:e.url,name:e.name,path:e.path}]),O(!1)},uploadUrl:route("events.certificates.upload-media",e.id),onUploadSuccess:()=>W(),onDelete:async t=>{const s=Array.isArray(t),n=s?{paths:t}:{path:t},a=s?t:[t];try{(await fetch(route("events.certificates.delete-media",e.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify(n)})).ok?(A(e=>e.filter(e=>!a.includes(e.path))),p(e=>e.filter(e=>"image"!==e.type&&"signature"!==e.type||!a.some(t=>e.src.includes(t)))),g&&a.some(e=>g.includes(e))&&y(null),le({message:"File(s) deleted successfully",type:"success"})):(console.error("Delete failed"),le({message:"Delete failed",type:"danger"}))}catch(r){console.error("Error deleting media:",r),le({message:"Error deleting media",type:"danger"})}},onRename:async(t,s)=>{try{const n=await fetch(route("events.certificates.rename-media",e.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({old_path:t,new_name:s})});if(n.ok){const e=await n.json();A(s=>s.map(s=>s.path===t?e:s)),le({message:"File renamed successfully",type:"success"})}else{const e=await n.json();le({message:e.error||"Rename failed",type:"danger"})}}catch(n){console.error(n),le({message:"Rename error",type:"danger"})}}})]})});const d=({type:e="horizontal",length:t=3e3,zoom:a=1,theme:r,offset:o=0,onDragStart:l})=>{const i="horizontal"===e,d=s.useMemo(()=>{const e=[];for(let t=0;t<=3e3;t+=10)e.push({pos:t,isMajor:t%100==0,label:t});return e},[]),c=i?{width:"100%",height:"24px",borderBottom:`1px solid ${r?.borderColor||"#ccc"}`,backgroundColor:r?.bg||"#f8f9fa",overflow:"hidden"}:{width:"24px",height:"100%",borderRight:`1px solid ${r?.borderColor||"#ccc"}`,backgroundColor:r?.bg||"#f8f9fa",overflow:"hidden"},x={position:"absolute",[i?"left":"top"]:o,[i?"top":"left"]:0,transformOrigin:"0 0"};return n.jsx("div",{className:`ruler-${e} d-flex position-relative user-select-none`,style:c,onMouseDown:t=>{t.preventDefault(),l&&l(e,t)},children:n.jsx("div",{style:x,children:d.map(({pos:e,isMajor:t,label:s})=>n.jsx("div",{className:"position-absolute",style:{[i?"left":"top"]:e*a+"px",[i?"top":"left"]:0,width:i?"1px":t?"12px":"6px",height:i?t?"12px":"6px":"1px",backgroundColor:r?.tickColor||"#94a3b8"},children:t&&n.jsx("span",{className:"position-absolute fs-10",style:{fontSize:"9px",color:r?.textColor||"#64748b",fontWeight:"600",[i?"left":"top"]:"4px",[i?"top":"left"]:"2px",transform:i?"none":"rotate(-90deg) translateX(-100%)",transformOrigin:"top left",whiteSpace:"nowrap"},children:s})},e))})})};function c({show:e,onClose:t,files:o=[],onSelect:l,uploadUrl:i,onUploadSuccess:d,onDelete:c,onRename:x}){const m=s.useRef(null),[p,h]=s.useState(""),[u,b]=s.useState(new Set),[f,g]=s.useState([]),[y,w]=s.useState(!1),v=s.useMemo(()=>p?o.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())):o,[o,p]);if(s.useEffect(()=>{e||(b(new Set),g([]))},[e]),!e)return null;const j=e=>{const t=[];Array.from(e).forEach(e=>{if(e.size>2097152)return void a.fire({icon:"error",title:"File too large",text:`${e.name} exceeds 2MB limit.`,customClass:{popup:"rounded-xl shadow-2xl border-0"}});const s={id:Math.random().toString(36).substring(7),file:e,name:e.name,progress:0,status:"pending",errorMsg:null};t.push(s),(async e=>{const t=new FormData;t.append("file",e.file);try{g(t=>t.map(t=>t.id===e.id?{...t,status:"uploading"}:t)),await r.post(i,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t=>{const s=Math.round(100*t.loaded/t.total);g(t=>t.map(t=>t.id===e.id?{...t,progress:s}:t))}}),g(t=>t.map(t=>t.id===e.id?{...t,status:"success",progress:100}:t)),d(),setTimeout(()=>{g(t=>t.filter(t=>t.id!==e.id))},3e3)}catch(s){console.error("Upload failed",s);let t="Upload failed";s.response?.data?.message?t=s.response.data.message:422===s.response?.status?t="Validation error":s.message&&(t=s.message),g(s=>s.map(s=>s.id===e.id?{...s,status:"error",errorMsg:t}:s))}})(s)}),t.length>0&&g(e=>[...e,...t])};return n.jsxs("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:3e3,backgroundColor:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:t,children:[n.jsx("style",{children:"\n                .swal2-container { z-index: 10000 !important; }\n                /* Overlay Styles */\n                .media-actions { opacity: 0; transition: opacity 0.2s ease; background-color: rgba(0, 0, 0, 0.4); }\n                .media-card:hover .media-actions { opacity: 1; }\n                .media-card.selected .media-actions { opacity: 1; background-color: rgba(0, 0, 0, 0.1); }\n                \n                .media-card { transition: all 0.2s ease; }\n                .media-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }\n                .custom-scrollbar::-webkit-scrollbar { width: 6px; }\n                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }\n                .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }\n                .button-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); border: none; }\n                .text-shadow { text-shadow: 0 1px 2px rgba(0,0,0,0.3); }\n                .drop-zone-active { border: 2px dashed #6366f1; background-color: rgba(99, 102, 241, 0.05); }\n            "}),n.jsxs("div",{className:"bg-white rounded-4 shadow-2xl overflow-hidden d-flex flex-column",style:{width:"900px",height:"85vh",maxWidth:"95%"},onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault(),w(!0)},onDragLeave:e=>{e.preventDefault(),w(!1)},onDrop:e=>{e.preventDefault(),w(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&j(e.dataTransfer.files)},children:[n.jsxs("div",{className:"px-4 py-3 border-bottom d-flex justify-content-between align-items-center bg-white sticky-top",children:[n.jsxs("div",{className:"d-flex align-items-center gap-3",children:[n.jsx("h5",{className:"m-0 fw-bold text-dark ls-tight",children:"Media Library"}),n.jsxs("div",{className:"bg-light rounded-pill px-3 py-1 text-xs fw-bold text-secondary",children:[o.length," Assets"]})]}),n.jsx("button",{className:"btn btn-icon btn-light rounded-circle shadow-sm",onClick:t,style:{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("i",{className:"fas fa-times"})})]}),n.jsxs("div",{className:"px-4 py-3 bg-white border-bottom d-flex gap-3 align-items-center",children:[n.jsxs("div",{className:"position-relative flex-grow-1",children:[n.jsx("i",{className:"fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"}),n.jsx("input",{type:"text",className:"form-control rounded-pill ps-5 bg-light border-0",placeholder:"Search your uploads...",value:p,onChange:e=>h(e.target.value),style:{height:"42px"}})]}),n.jsx("input",{type:"file",ref:m,className:"d-none",accept:"image/*",multiple:!0,onChange:e=>{e.target.files&&e.target.files.length>0&&j(e.target.files),e.target.value=""}}),n.jsxs("button",{className:"btn btn-primary rounded-pill px-4 fw-medium d-flex align-items-center gap-2 shadow-sm button-gradient",onClick:()=>m.current.click(),style:{height:"42px"},children:[n.jsx("i",{className:"fas fa-cloud-upload-alt"}),n.jsx("span",{children:"Upload Media"})]})]}),n.jsxs("div",{className:"p-4 overflow-auto grow bg-light custom-scrollbar position-relative "+(y?"drop-zone-active":""),children:[y&&n.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{zIndex:50,backgroundColor:"rgba(255,255,255,0.8)",backdropFilter:"blur(2px)"},children:n.jsxs("div",{className:"text-center text-primary animate-bounce",children:[n.jsx("i",{className:"fas fa-cloud-upload-alt fa-3x mb-3"}),n.jsx("h4",{className:"fw-bold",children:"Drop files to upload"})]})}),0===v.length&&0===f.length?n.jsx("div",{className:"h-100 d-flex flex-column align-items-center justify-content-center text-center opacity-75",onClick:()=>m.current.click(),style:{cursor:"pointer"},children:p?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"mb-3 p-3 bg-white rounded-circle shadow-sm text-secondary",children:n.jsx("i",{className:"fas fa-search fs-2"})}),n.jsx("h6",{className:"fw-bold text-dark",children:"No matches found"}),n.jsx("p",{className:"text-secondary small",children:"Try a different search term"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"mb-4 text-muted",children:n.jsx("i",{className:"fas fa-cloud-upload-alt fa-4x mb-3 text-primary opacity-50"})}),n.jsx("h6",{className:"fw-bold text-dark mb-2",children:"Library is Empty"}),n.jsx("p",{className:"text-secondary small mb-4",children:"Drag & drop images here or click to browse"})]})}):n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1.25rem"},children:[f.map(e=>n.jsxs("div",{className:"bg-white rounded-3 p-3 border shadow-sm d-flex flex-column justify-content-center position-relative overflow-hidden",style:{aspectRatio:"1"},children:[n.jsx("div",{className:"text-center mb-2",children:n.jsx("i",{className:`fas ${"error"===e.status?"fa-exclamation-circle text-danger":"fa-image text-muted"} fs-3`})}),n.jsx("div",{className:"text-xs text-truncate text-center mb-2 fw-medium",children:e.name}),"error"===e.status?n.jsx("div",{className:"text-danger text-xs text-center",children:e.errorMsg}):n.jsx("div",{className:"w-100 bg-light rounded-pill overflow-hidden",style:{height:"6px"},children:n.jsx("div",{className:"bg-primary h-100 transition-all duration-300",style:{width:`${e.progress}%`}})}),"success"===e.status&&n.jsx("div",{className:"position-absolute top-0 end-0 p-1 text-success bg-white rounded-circle m-2 shadow-sm",children:n.jsx("i",{className:"fas fa-check-circle"})})]},e.id)),v.map(e=>{const t=u.has(e.path);return n.jsxs("div",{className:"media-card position-relative bg-white rounded-3 overflow-hidden border "+(t?"selected border-primary ring-2 ring-primary ring-opacity-50":"border-light"),style:{aspectRatio:"1",cursor:"pointer",transition:"all 0.2s",transform:t?"scale(0.98)":"scale(1)"},onClick:t=>((e,t)=>{e.stopPropagation();const s=new Set(u);s.has(t.path)?s.delete(t.path):s.add(t.path),b(s)})(t,e),children:[n.jsx("div",{className:"position-absolute top-0 start-0 p-2",style:{zIndex:20},children:n.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center shadow-sm border "+(t?"bg-primary border-primary text-white":"bg-white border-secondary"),style:{width:"24px",height:"24px",transition:"all 0.2s"},children:t&&n.jsx("i",{className:"fas fa-check",style:{fontSize:"12px"}})})}),n.jsx("div",{className:"w-100 h-100 p-3 d-flex align-items-center justify-content-center",style:{backgroundColor:"#f8f9fa",backgroundImage:"radial-gradient(#cbd5e1 1px, transparent 1px)",backgroundSize:"10px 10px"},children:n.jsx("img",{src:e.url,alt:e.name,className:"mw-100 mh-100 object-fit-contain shadow-sm rounded-2",onError:e=>{e.target.onerror=null,e.target.src="https://via.placeholder.com/150?text=Error"}})}),n.jsx("div",{className:"media-actions position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",children:n.jsxs("div",{className:"position-absolute top-0 end-0 p-2 d-flex gap-2",style:{zIndex:20},children:[n.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-primary d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:t=>((e,t)=>{e.stopPropagation();const s=t.name,n=s.substring(0,s.lastIndexOf("."))||s;a.fire({title:"Rename File",text:`Enter new name for "${s}"`,input:"text",inputValue:n,showCancelButton:!0,confirmButtonText:"Rename",confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",inputValidator:e=>{if(!e)return"You need to write something!"},customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-blue-500 hover:bg-blue-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2",input:"form-control shadow-none border-gray-300 rounded-lg w-75 mx-auto"}}).then(e=>{e.isConfirmed&&x(t.path,e.value)})})(t,e),title:"Rename",children:n.jsx("i",{className:"fas fa-pen",style:{fontSize:"14px"}})}),n.jsx("button",{className:"btn btn-light btn-sm rounded-circle shadow-sm text-danger d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:t=>((e,t)=>{e.stopPropagation(),a.fire({title:"Delete this file?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Delete",cancelButtonText:"Cancel",customClass:{popup:"rounded-xl shadow-2xl border-0",title:"text-lg font-bold text-gray-800",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2",cancelButton:"bg-gray-500 hover:bg-gray-600 border-0 rounded-lg px-4 py-2"}}).then(e=>{if(e.isConfirmed){c(t);const e=new Set(u);e.has(t)&&(e.delete(t),b(e))}})})(t,e.path),title:"Delete",children:n.jsx("i",{className:"fas fa-trash-alt",style:{fontSize:"14px"}})})]})}),n.jsx("div",{className:"position-absolute bottom-0 w-100 bg-white border-top p-2",children:n.jsx("div",{className:"text-truncate text-xs fw-medium text-secondary text-center",children:e.name})})]},e.path)})]})]}),n.jsxs("div",{className:"bg-white border-top px-4 py-3 d-flex justify-content-between align-items-center",children:[n.jsxs("div",{className:"d-flex align-items-center gap-3",children:[n.jsxs("small",{className:"text-muted text-xs",children:[u.size," selected"]}),u.size>0&&n.jsxs("button",{className:"btn btn-danger btn-sm rounded-pill px-3 shadow-sm d-flex align-items-center gap-2",onClick:e=>{e.stopPropagation(),a.fire({title:`Delete ${u.size} files?`,text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete",customClass:{popup:"rounded-xl shadow-2xl border-0",confirmButton:"bg-red-500 hover:bg-red-600 border-0 rounded-lg px-4 py-2"}}).then(e=>{e.isConfirmed&&(c(Array.from(u)),b(new Set))})},children:[n.jsx("i",{className:"fas fa-trash-alt"}),n.jsx("span",{children:"Delete Selected"})]})]}),n.jsxs("button",{className:"btn btn-primary rounded-pill px-4 fw-bold shadow-sm "+(0===u.size?"disabled opacity-50":"button-gradient"),onClick:()=>{const e=o.filter(e=>u.has(e.path));l(e),b(new Set)},disabled:0===u.size,children:["Insert Selected (",u.size,")"]})]})]})]})}}}});
