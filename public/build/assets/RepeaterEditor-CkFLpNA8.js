import{j as e,r as v,R}from"./app-8jlO-GOR.js";import{u as E,a as N,D as k,c as T,S as D,v as _,s as O,K as P,P as A,b as z,d as K,C as M}from"./sortable.esm-ENtqbFO9.js";function w({schema:x,data:l,onChange:o}){const u=(s,g)=>{o({...l,[s]:g})},f=(s,g,m,y="")=>{const i=s.name,d=g?.[i]!==void 0?g[i]:s.type==="repeater"?[]:"",b=y+i;switch(s.type){case"text":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:s.label}),e.jsx("input",{type:"text",value:d,onChange:a=>m(i,a.target.value),className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 text-gray-800"})]},b);case"textarea":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:s.label}),e.jsx("textarea",{value:d,onChange:a=>m(i,a.target.value),rows:3,className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 resize-y text-gray-800"})]},b);case"image":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:s.label}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 overflow-hidden flex-shrink-0 relative group",children:d?e.jsx("img",{src:d,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx("i",{className:"fa-regular fa-image"})})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",value:d,onChange:a=>m(i,a.target.value),placeholder:"Image URL...",className:"w-full text-xs border-gray-300 rounded shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{const t=a.target.files[0];if(!t)return;const n=new FormData;n.append("file",t);const r=a.target.nextElementSibling;r&&(r.innerText="Uploading..."),fetch("/admin/upload-media",{method:"POST",body:n,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}}).then(c=>c.json()).then(c=>{c.url&&m(i,c.url)}).catch(c=>console.error("Upload failed",c)).finally(()=>{r&&(r.innerText="Choose File"),a.target.value=null})},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsxs("button",{className:"w-full bg-white border border-gray-300 hover:bg-gray-50 text-gray-600 text-xs py-1.5 px-3 rounded shadow-sm flex items-center justify-center gap-2 transition",children:[e.jsx("i",{className:"fa-solid fa-cloud-arrow-up"}),e.jsx("span",{children:"Choose File"})]})]})]})]})]},b);case"select":return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:s.label}),e.jsx("select",{value:d,onChange:a=>m(i,a.target.value),className:"w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-act-primary focus:ring focus:ring-act-primary/20 bg-gray-50 text-gray-800",children:s.options?.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]},b);case"repeater":return e.jsx(S,{label:s.label,items:d,schema:s.schema,onChange:a=>m(i,a)},b);default:return null}};return!x||x.length===0?e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-100 rounded-lg text-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-400",children:e.jsx("i",{className:"fa-regular fa-lock"})}),e.jsx("h4",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Read Only Section"}),e.jsx("p",{className:"text-xs text-gray-500 leading-relaxed",children:"This section uses legacy content and is not editable."})]}):e.jsx("div",{className:"space-y-1",children:x.map(s=>f(s,l,u))})}const F=Object.freeze(Object.defineProperty({__proto__:null,default:w},Symbol.toStringTag,{value:"Module"}));function U({id:x,index:l,data:o,schema:u,onRemove:f,onChange:s,expandedId:g,onToggleExpand:m}){const{attributes:y,listeners:i,setNodeRef:d,transform:b,transition:a,isDragging:t}=K({id:x}),n={transform:M.Transform.toString(b),transition:a,opacity:t?.5:1,position:"relative",zIndex:t?999:"auto"},r=g===x,c=()=>typeof o!="object"?o:o.title||o.name||o.text||o.label||`Item #${l+1}`;return e.jsxs("div",{ref:d,style:n,className:"bg-white border border-gray-200 rounded-lg mb-2 shadow-sm group",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border-b border-gray-100 rounded-t-lg select-none",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{...y,...i,className:"cursor-grab active:cursor-grabbing text-gray-400 p-1 hover:text-gray-600",children:e.jsx("i",{className:"fa-solid fa-grip-lines"})}),e.jsxs("button",{type:"button",onClick:()=>m(x),className:"text-xs font-semibold text-gray-700 truncate flex-1 text-left",children:[r?e.jsx("i",{className:"fa-solid fa-chevron-down mr-2 text-[10px] text-gray-400"}):e.jsx("i",{className:"fa-solid fa-chevron-right mr-2 text-[10px] text-gray-400"}),c()]})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{type:"button",onClick:()=>f(l),className:"w-6 h-6 rounded flex items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 transition",title:"Remove Item",children:e.jsx("i",{className:"fa-regular fa-trash text-xs"})})})]}),r&&e.jsx("div",{className:"p-3 bg-white rounded-b-lg",children:u?e.jsx(w,{schema:u,data:o,onChange:h=>s(l,h)}):e.jsx("input",{type:"text",value:o,onChange:h=>s(l,h.target.value),className:"w-full text-sm border-gray-300 rounded"})})]})}function S({label:x,items:l=[],schema:o,onChange:u}){const[f,s]=v.useState(()=>(l||[]).map(t=>({id:`item-${Math.random().toString(36).substr(2,9)}`,data:t})));R.useEffect(()=>{s(t=>t.length===l.length?t.map((n,r)=>({...n,data:l[r]})):(l||[]).map(n=>({id:`item-${Math.random().toString(36).substr(2,9)}`,data:n})))},[l]);const[g,m]=v.useState(null),y=E(N(A),N(P,{coordinateGetter:O})),i=t=>{const{active:n,over:r}=t;r&&n.id!==r.id&&s(c=>{const h=c.findIndex(p=>p.id===n.id),I=c.findIndex(p=>p.id===r.id),j=z(c,h,I),C=j.map(p=>p.data);return u(C),j})},d=()=>{const t={};o&&o.forEach(r=>{t[r.name]=r.type==="repeater"?[]:""});const n=[...l,t];u(n)},b=t=>{if(!confirm("Remove this item?"))return;const n=[...l];n.splice(t,1),u(n)},a=(t,n)=>{const r=[...l];r[t]=n,u(r)};return e.jsxs("div",{className:"mb-6 border border-gray-200 rounded-lg overflow-hidden flex flex-col bg-gray-50/50",children:[e.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b border-gray-200 flex justify-between items-center group",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-600 tracking-wider",children:x}),e.jsxs("button",{type:"button",onClick:d,className:"text-xs bg-white hover:bg-act-primary hover:text-white border border-gray-300 hover:border-act-primary text-gray-700 px-2 py-1 rounded shadow-sm transition flex items-center",children:[e.jsx("i",{className:"fa-solid fa-plus mr-1"})," Add"]})]}),e.jsx("div",{className:"p-2",children:e.jsx(k,{sensors:y,collisionDetection:T,onDragEnd:i,children:e.jsx(D,{items:f.map(t=>t.id),strategy:_,children:f.length===0?e.jsx("div",{className:"text-center py-6 text-gray-400 text-xs italic",children:"No items yet."}):f.map((t,n)=>e.jsx(U,{id:t.id,index:n,data:t.data,schema:o,onRemove:b,onChange:a,expandedId:g,onToggleExpand:r=>m(r===g?null:r)},t.id))})})})]})}const L=Object.freeze(Object.defineProperty({__proto__:null,default:S},Symbol.toStringTag,{value:"Module"}));export{L as R,w as S,F as a};
