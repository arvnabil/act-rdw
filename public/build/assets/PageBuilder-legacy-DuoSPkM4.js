System.register(["./react-core-legacy-MaQOtt75.js","./vendor-legacy-DG0v0S8r.js","./BuilderHeader-legacy-CSirwT10.js","./BuilderSidebar-legacy-CY9J9CAe.js","./BuilderCanvas-legacy-CbjJAncX.js","./InspectorPanel-legacy-YHRz54ol.js","./sectionRegistry-legacy-DeEvyoIs.js","./SortableSectionItem-legacy-C0Xs2SWp.js","./SectionPreview-legacy-DXG2tiqi.js","./ErrorBoundary-legacy-Df02MENq.js","./RepeaterEditor-legacy-PWsFpnRt.js","./ServiceCtaSection-legacy-nQ5yKcDm.js","./NewsSection-legacy-CuI2allM.js","./whatsapp-legacy-TvHSf1_t.js","./ui-swiper-legacy-CKGAcGy_.js","./SectionTitle-legacy-BWHBgNVt.js","./image-legacy-BtpSotYe.js","./VisionMissionSection-legacy-CtS4pPDz.js"],function(e,t){"use strict";var n,s,i,l,o,r,a,c,u,d;return{setters:[e=>{n=e.r,s=e.f,i=e.j,l=e.H},e=>{o=e.S},e=>{r=e.default},e=>{a=e.default},e=>{c=e.default},e=>{u=e.default},e=>{d=e.s},null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",function({page:e,sections:t,allServices:f,allProjects:p}){const{state:g,set:y,undo:v,redo:S,canUndo:j,canRedo:h}=function(e,t=50){const[s,i]=n.useState({past:[],present:e,future:[]}),l=s.past.length>0,o=s.future.length>0,r=n.useCallback(()=>{i(e=>{if(0===e.past.length)return e;const t=e.past[e.past.length-1];return{past:e.past.slice(0,-1),present:t,future:[e.present,...e.future]}})},[]),a=n.useCallback(()=>{i(e=>{if(0===e.future.length)return e;const t=e.future[0],n=e.future.slice(1);return{past:[...e.past,e.present],present:t,future:n}})},[]),c=n.useCallback(e=>{i(n=>{const s="function"==typeof e?e(n.present):e;if(JSON.stringify(s)===JSON.stringify(n.present))return n;const i=[...n.past,n.present];return i.length>t&&i.shift(),{past:i,present:s,future:[]}})},[t]);return{state:s.present,set:c,undo:r,redo:a,canUndo:l,canRedo:o,historyState:s}}(t||[],50),[m,w]=n.useState(null),[x,k]=n.useState(!1),[C,b]=n.useState(!0),[B,E]=n.useState(!0),[K,N]=n.useState("desktop"),R=g.find(e=>e.id===m)||null;n.useEffect(()=>{m&&E(!0)},[m]);const D=e=>{const t=e.map((e,t)=>({...e,position:t}));y(t)},P=n.useCallback(()=>{k(!0),s.post(`/admin/page-builder/${e.id}/save`,{sections:g.map((e,t)=>({id:String(e.id).startsWith("new-")?null:e.id,section_key:e.section_key,config:JSON.stringify(e.config||{}),position:t,is_active:e.is_active}))},{preserveScroll:!0,onSuccess:()=>{k(!1),o.fire({toast:!0,position:"top-end",icon:"success",title:"Page saved successfully",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})},onError:e=>{k(!1),o.fire({toast:!0,position:"top-end",icon:"error",title:"Failed to save page",showConfirmButton:!1,timer:3e3})}})},[e.id,g]);return n.useEffect(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"s"===e.key&&(e.preventDefault(),P()),!e.metaKey&&!e.ctrlKey||"z"!==e.key||e.shiftKey||(e.preventDefault(),j&&v()),(e.metaKey||e.ctrlKey)&&("z"===e.key&&e.shiftKey||"y"===e.key)&&(e.preventDefault(),h&&S()),"Escape"===e.key&&w(null)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[P,v,S,j,h]),i.jsxs("div",{className:"h-screen flex flex-col bg-gray-100 font-sans overflow-hidden",children:[i.jsx(l,{title:`Builder: ${e.title}`}),i.jsx("div",{className:"flex-none z-50",children:i.jsx(r,{page:e,onSave:P,isSaving:x,previewDevice:K,setPreviewDevice:N,onUndo:v,onRedo:S,canUndo:j,canRedo:h})}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsx(a,{sections:g,onReorder:D,onSelect:w,selectedSectionId:m,onAddSection:e=>{const t=d[e];if(!t)return;const n={id:`new-${Date.now()}`,section_key:e,config:t.defaultConfig||{},position:g.length,is_active:!0},s=[...g,n];y(s),w(n.id)},onRemove:e=>{confirm("Are you sure you want to remove this section? This action will be saved when you click 'Save Changes'.")&&(y(t=>t.filter(t=>t.id!==e)),m===e&&w(null))},isOpen:C,onToggle:()=>b(!C)}),i.jsx("main",{className:"flex-1 bg-gray-100/50 relative overflow-hidden flex flex-col",children:i.jsx(c,{sections:g,selectedSectionId:m,onSelectSection:w,onMoveSection:D,previewDevice:K,allServices:f,allProjects:p})}),i.jsx(u,{section:R,onUpdate:e=>{y(g.map(t=>t.id===e.id?e:t))},isOpen:B,onToggle:()=>E(!B),onClose:()=>w(null)})]})]})})}}});
